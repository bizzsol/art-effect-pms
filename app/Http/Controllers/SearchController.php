<?php
bolt_decrypt( __FILE__ , 'Ah4Cpp'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnM7Cgp1c2UgQXBwXE1vZGVsc1xFbXBsb3llZTsKdXNlIElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0Owp1c2UgSWxsdW1pbmF0ZVxTdXBwb3J0XEZhY2FkZXNcQXJ0aXNhbjsKdXNlIERCOwoKY2xhc3MgU2VhcmNoQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgcHVibGljIGZ1bmN0aW9uIHNlYXJjaEVtcChSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgICRpbnB1dCA9ICRyZXF1ZXN0LT5hbGwoKTsKICAgICAgICAkZ2V0RW1wbG95ZWUgPSBFbXBsb3llZTo6Z2V0U2VhcmNoR2xvYmFsS2V5V2lzZSgkaW5wdXRbJ25hbWVfc3RhcnRzV2l0aCddKTsKCiAgICAgICAgJGRhdGEgPSBhcnJheSgpOwoKICAgICAgICBpZihjb3VudCgkZ2V0RW1wbG95ZWUpID4gMCl7CiAgICAgICAgICAgIGZvcmVhY2ggKCRnZXRFbXBsb3llZSBhcyAkZW1wKSB7CiAgICAgICAgICAgICAgICAkZGF0YVtdID0gJGVtcC0+YXNzb2NpYXRlX2lkLicgLSAnLiRlbXAtPmFzX25hbWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuICRkYXRhOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzZWFyY2goUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkaW5wdXQgPSAkcmVxdWVzdC0+YWxsKCk7CiAgICAgICAgJGlucHV0RXhwID0gZXhwbG9kZSgnLScsICRpbnB1dFsnc2VhcmNoJ10pOwogICAgICAgICRpbnB1dFsnc2VhcmNoJ10gPSAkaW5wdXRFeHBbMF07CiAgICAgICAgJGdldEVtcGxveWVlID0gRW1wbG95ZWU6OmdldFNlYXJjaEtleVdpc2UoJGlucHV0WydzZWFyY2gnXSk7CiAgICAgICAgcmV0dXJuIHZpZXcoJ2NvbW1vbi5zZWFyY2hfcmVzdWx0JywgY29tcGFjdCgnZ2V0RW1wbG95ZWUnKSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN1Z2dlc3Rpb24oUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAka2V5d29yZCA9ICRyZXF1ZXN0LT5rZXl3b3JkOwoKICAgICAgICAkZW1wbG95ZWVzID0gREI6OnRhYmxlKCdocl9hc19iYXNpY19pbmZvJykKICAgICAgICAtPnNlbGVjdCgnYXNfbmFtZScsICdhc3NvY2lhdGVfaWQnLCAnYXNfcGljJywgJ2FzX2dlbmRlcicsJ2FzX3N0YXR1cycpCiAgICAgICAgLT53aGVyZShmdW5jdGlvbiAoJHEpIHVzZSAoJGtleXdvcmQpIHsKICAgICAgICAgICAgJHEtPndoZXJlKCdhc3NvY2lhdGVfaWQnLCAnTElLRScsICclJy4gJGtleXdvcmQgLiclJyk7CiAgICAgICAgICAgICRxLT5vcldoZXJlKCdhc19uYW1lJywgJ0xJS0UnLCAnJScuICRrZXl3b3JkIC4gJyUnKTsKICAgICAgICAgICAgJHEtPm9yV2hlcmUoJ2FzX29yYWNsZV9jb2RlJywgJ0xJS0UnLCAnJScuICRrZXl3b3JkIC4gJyUnKTsKICAgICAgICB9KQogICAgICAgIC0+d2hlcmVJbignYXNfdW5pdF9pZCcsIGF1dGgoKS0+dXNlcigpLT51bml0X3Blcm1pc3Npb25zKCkpCiAgICAgICAgLT53aGVyZSgnYXNfc3RhdHVzJywgMSkKICAgICAgICAtPmxpbWl0KDUpCiAgICAgICAgLT5nZXQoKTsKCgogICAgICAgIHJldHVybiB2aWV3KCdjb21tb24uc2VhcmNoX3N1Z2dlc3Rpb24nLCBjb21wYWN0KCdlbXBsb3llZXMnLCdrZXl3b3JkJykpLT5yZW5kZXIoKTsKICAgIH0KICAgIAogICAgCiAgICBwdWJsaWMgZnVuY3Rpb24gcmVzZXQoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAKICAgICAgICBBcnRpc2FuOjpjYWxsKCdjYWNoZTpjbGVhcicpOwogICAgICAgIEFydGlzYW46OmNhbGwoJ2NvbmZpZzpjbGVhcicpOwogICAgICAgIEFydGlzYW46OmNhbGwoJ3ZpZXc6Y2xlYXInKTsKICAgICAgICBjYWNoZV9kYWlseV9vcGVyYXRpb24oKTsKICAgICAgICAKICAgICAgICByZXR1cm4gcmVkaXJlY3QoKS0+YmFjaygpOwogICAgfQoKCgoKCgp9Cg==