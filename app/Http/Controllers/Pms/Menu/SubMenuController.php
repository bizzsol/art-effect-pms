<?php
bolt_decrypt( __FILE__ , 'eCQoe3'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zXE1lbnU7Cgp1c2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcQ29udHJvbGxlcjsKCnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xNZW51XE1lbnU7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xNZW51XFN1Yk1lbnU7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xNZW51XFN1YlN1Yk1lbnU7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBBcHBcSHR0cFxSZXF1ZXN0czsKCnVzZSBWYWxpZGF0b3IsSW1hZ2U7CnVzZSBTcGF0aWVcUGVybWlzc2lvblxNb2RlbHNcUGVybWlzc2lvbjsKCmNsYXNzIFN1Yk1lbnVDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlcgp7CiAgICBwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKXsKICAgICAgICAkdGhpcy0+bWlkZGxld2FyZSgnYXV0aCcpOwogICAgfQogICAgLyoqCiAgICAgKiBEaXNwbGF5IGEgbGlzdGluZyBvZiB0aGUgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgLy8KICAgIH0KCiAgICAvKioKICAgICAqIFNob3cgdGhlIGZvcm0gZm9yIGNyZWF0aW5nIGEgbmV3IHJlc291cmNlLgogICAgICoKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gY3JlYXRlKCkKICAgIHsKICAgICAgICAvLwogICAgfQoKICAgIC8qKgogICAgICogU3RvcmUgYSBuZXdseSBjcmVhdGVkIHJlc291cmNlIGluIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3QgICRyZXF1ZXN0CiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgJGlucHV0ID0gJHJlcXVlc3QtPmFsbCgpOwoKCiAgICAgICAgJHZhbGlkYXRvciA9IFZhbGlkYXRvcjo6bWFrZSgkaW5wdXQsIFsgICAKICAgICAgICAgICAgJ25hbWUnICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3VybCcgICAgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2ljb24nID0+ICdtaW1lczpqcGVnLGpwZyxibXAscG5nJwogICAgICAgIF0pOwogICAgICAgIGlmICgkdmFsaWRhdG9yLT5mYWlscygpKSB7CiAgICAgICAgICAgIHJldHVybiByZWRpcmVjdCgpLT5iYWNrKCktPndpdGhFcnJvcnMoJHZhbGlkYXRvciktPndpdGhJbnB1dCgpOwogICAgICAgIH0KCiAgICAgICAgdHJ5ewogICAgICAgICAgICAkaW5wdXRbJ3NsdWcnXSA9IGpzb25fZW5jb2RlKCRyZXF1ZXN0LT5zbHVnKTsKCiAgICAgICAgICAgIGlmICgkcmVxdWVzdC0+aGFzRmlsZSgnaWNvbicpKXsKICAgICAgICAgICAgICAgICRpbnB1dFsnaWNvbiddPSR0aGlzLT5waG90b1VwbG9hZCgkcmVxdWVzdC0+ZmlsZSgnaWNvbicpLCdpbWFnZXMvbWVudS9zdWItbWVudS9pY29uLycsMzIpOwogICAgICAgICAgICAgICAgLy8kaW5wdXRbJ2JpZ19pY29uJ109TXlIZWxwZXI6OnBob3RvVXBsb2FkKCRyZXF1ZXN0LT5maWxlKCdpY29uJyksJ2ltYWdlcy9tZW51L3N1Yi1tZW51L2JpZy1pY29uLycsMTI4KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGlucHV0Wydtb2R1bGUnXSA9IE1lbnU6OmZpbmQoJHJlcXVlc3QtPm1lbnVfaWQpLT5tb2R1bGU7CgogICAgICAgICAgICBTdWJNZW51OjpjcmVhdGUoJGlucHV0KTsKCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhTdWNjZXNzKCdNZW51IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgfWNhdGNoKFxFeGNlcHRpb24gJGUpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJGUtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQoKICAgIH0KCiAgICAvKioKICAgICAqIERpc3BsYXkgdGhlIHNwZWNpZmllZCByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHNob3coJGlkKQogICAgewogICAgICAgIC8vJHBhZ2U9UGFnZTo6d2hlcmUoJ3N0YXR1cycsMSktPnBsdWNrKCduYW1lJywnbGluaycpOwogICAgICAgICRhbGxEYXRhPVN1Yk1lbnU6OmxlZnRKb2luKCdtZW51cycsJ3N1Yl9tZW51cy5tZW51X2lkJywnPScsJ21lbnVzLmlkJyktPnNlbGVjdCgnc3ViX21lbnVzLionLCdtZW51cy5uYW1lIGFzIG1lbnVfbmFtZScpLT53aGVyZSgnbWVudV9pZCcsJGlkKS0+b3JkZXJCeSgnc2VyaWFsX251bScsJ0RFU0MnKS0+cGFnaW5hdGUoMjApOwoKICAgICAgICAkbWVudT1NZW51OjpmaW5kT3JGYWlsKCRpZCk7CiAgICAgICAgJHRpdGxlPSdDcmVhdGUgc3VibWVudSB1bmRlciB0aGUgKCcuJG1lbnUtPm5hbWUuJykgTWFpbiBNZW51JzsKICAgICAgICAkbWF4X3NlcmlhbD1TdWJNZW51Ojp3aGVyZSgnbWVudV9pZCcsJGlkKS0+bWF4KCdzZXJpYWxfbnVtJyk7CiAgICAgICAgJHBlcm1pc3Npb25zID0gUGVybWlzc2lvbjo6b3JkZXJCeSgnaWQnLCdERVNDJyktPnBsdWNrKCduYW1lJywgJ25hbWUnKTsKICAgICAgICAkbWVudUZvcj1bCiAgICAgICAgICAgIFN1Yk1lbnU6OkFETUlOX01FTlUgPT4gU3ViTWVudTo6QURNSU5fTUVOVSwKICAgICAgICAgICAgU3ViTWVudTo6Q0xJRU5UX01FTlUgPT4gU3ViTWVudTo6Q0xJRU5UX01FTlUsCiAgICAgICAgICAgIFN1Yk1lbnU6OlVTRVJfTUVOVSA9PiBTdWJNZW51OjpVU0VSX01FTlUKICAgICAgICBdOwogICAgICAgICRzdGF0dXM9W1N1Yk1lbnU6OkFDVElWRSAgPT4gU3ViTWVudTo6QUNUSVZFICwKICAgICAgICAgICAgU3ViTWVudTo6SU5BQ1RJVkUgID0+IFN1Yk1lbnU6OklOQUNUSVZFXTsKCiAgICAgICAgJG9wZW5UYWI9W1N1Yk1lbnU6Ok5PX09QRU5fTkVXX1RBQiAgPT4gU3ViTWVudTo6Tk9fT1BFTl9ORVdfVEFCICwKICAgICAgICAgICAgU3ViTWVudTo6T1BFTl9ORVdfVEFCICA9PiBTdWJNZW51OjpPUEVOX05FV19UQUJdOwoKICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMubWVudS5zdWJtZW51Jyxjb21wYWN0KCd0aXRsZScsJ2FsbERhdGEnLCdtYXhfc2VyaWFsJywnbWVudScsJ3Blcm1pc3Npb25zJywnbWVudUZvcicsJ3N0YXR1cycsJ29wZW5UYWInKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaG93IHRoZSBmb3JtIGZvciBlZGl0aW5nIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KCiAgICBwdWJsaWMgZnVuY3Rpb24gZWRpdCgkaWQpCiAgICB7CiAgICAgICAgJGRhdGE9U3ViTWVudTo6bGVmdEpvaW4oJ21lbnVzJywnc3ViX21lbnVzLm1lbnVfaWQnLCc9JywnbWVudXMuaWQnKS0+c2VsZWN0KCdzdWJfbWVudXMuKicsJ21lbnVzLm5hbWUgYXMgbWVudV9uYW1lJykKICAgICAgICAgICAgLT53aGVyZSgnc3ViX21lbnVzLmlkJywkaWQpLT5vcmRlckJ5KCdzZXJpYWxfbnVtJywnREVTQycpLT5maXJzdCgyMCk7CgogICAgICAgICRtZW51PU1lbnU6OmZpbmRPckZhaWwoJGRhdGEtPm1lbnVfaWQpOwogICAgICAgICRtYXhfc2VyaWFsPVN1Yk1lbnU6OndoZXJlKCdtZW51X2lkJywkZGF0YS0+bWVudV9pZCktPm1heCgnc2VyaWFsX251bScpOwogICAgICAgICRwZXJtaXNzaW9ucyA9IFBlcm1pc3Npb246Om9yZGVyQnkoJ2lkJywnREVTQycpLT5wbHVjaygnbmFtZScsICduYW1lJyk7CgogICAgICAgICRtZW51Rm9yPVsKICAgICAgICAgICAgU3ViTWVudTo6QURNSU5fTUVOVSA9PiBTdWJNZW51OjpBRE1JTl9NRU5VLAogICAgICAgICAgICBTdWJNZW51OjpDTElFTlRfTUVOVSA9PiBTdWJNZW51OjpDTElFTlRfTUVOVSwKICAgICAgICAgICAgU3ViTWVudTo6VVNFUl9NRU5VID0+IFN1Yk1lbnU6OlVTRVJfTUVOVQogICAgICAgIF07CiAgICAgICAgJHN0YXR1cz1bU3ViTWVudTo6QUNUSVZFICA9PiBTdWJNZW51OjpBQ1RJVkUgLAogICAgICAgICAgICBTdWJNZW51OjpJTkFDVElWRSAgPT4gU3ViTWVudTo6SU5BQ1RJVkVdOwoKICAgICAgICAkb3BlblRhYj1bU3ViTWVudTo6Tk9fT1BFTl9ORVdfVEFCICA9PiBTdWJNZW51OjpOT19PUEVOX05FV19UQUIgLAogICAgICAgICAgICBTdWJNZW51OjpPUEVOX05FV19UQUIgID0+IFN1Yk1lbnU6Ok9QRU5fTkVXX1RBQl07CiAgICAgICAgJHRpdGxlPSdFZGl0IHN1Ym1lbnUgdW5kZXIgdGhlICgnLiRtZW51LT5uYW1lLicpIE1haW4gTWVudSc7CiAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLm1lbnUuc3VibWVudUVkaXQnLGNvbXBhY3QoJ2RhdGEnLCdtYXhfc2VyaWFsJywnbWVudScsJ3Blcm1pc3Npb25zJywnbWVudUZvcicsJ3N0YXR1cycsJ29wZW5UYWInLCd0aXRsZScpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgc3BlY2lmaWVkIHJlc291cmNlIGluIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3QgICRyZXF1ZXN0CiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAkaW5wdXQgPSAkcmVxdWVzdC0+YWxsKCk7CiAgICAgICAgJGRhdGE9U3ViTWVudTo6ZmluZE9yRmFpbCgkaWQpOwogICAgICAgIAogICAgICAgICR2YWxpZGF0b3IgPSBWYWxpZGF0b3I6Om1ha2UoJGlucHV0LCBbCiAgICAgICAgICAgICduYW1lJyAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAndXJsJyAgICAgICAgICA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnaWNvbicgPT4gJ21pbWVzOmpwZWcsanBnLGJtcCxwbmcnCiAgICAgICAgICAgLy8gJ2ljb24nID0+ICdtaW1lczpqcGVnLGpwZyxibXAscG5nfGRpbWVuc2lvbnM6bWluX3dpZHRoPTEyOCxtYXhfd2lkdGg9MjU2JwogICAgICAgIF0pOwogICAgICAgIAogICAgICAgIGlmICgkdmFsaWRhdG9yLT5mYWlscygpKSB7CiAgICAgICAgICAgIHJldHVybiByZWRpcmVjdCgpLT5iYWNrKCktPndpdGhFcnJvcnMoJHZhbGlkYXRvciktPndpdGhJbnB1dCgpOwogICAgICAgIH0KCiAgICAgICAgdHJ5ewogICAgICAgICAgICAvLyRpbnB1dFsnc2x1ZyddPWpzb25fZW5jb2RlKCRyZXF1ZXN0LT5zbHVnKTsKICAgICAgICAgICAgaWYgKCRyZXF1ZXN0LT5oYXNGaWxlKCdpY29uJykpewogICAgICAgICAgICAgICAgJGlucHV0WydpY29uJ109JHRoaXMtPnBob3RvVXBsb2FkKCRyZXF1ZXN0LT5maWxlKCdpY29uJyksJ2ltYWdlcy9tZW51L3N1Yi1tZW51L2ljb24vJywzMik7CiAgICAgICAgICAgICAgICAvLyRpbnB1dFsnYmlnX2ljb24nXT1NeUhlbHBlcjo6cGhvdG9VcGxvYWQoJHJlcXVlc3QtPmZpbGUoJ2ljb24nKSwnaW1hZ2VzL21lbnUvYmlnLWljb24vJywxMjgpOwogICAgICAgICAgICAgICAgaWYgKGZpbGVfZXhpc3RzKGFzc2V0KCRkYXRhLT5pY29uKSkpeyB1bmxpbmsoYXNzZXQoJGRhdGEtPmljb24pKTsgIH0KICAgICAgICAgICAgICAgIGlmIChmaWxlX2V4aXN0cyhhc3NldCgkZGF0YS0+YmlnX2ljb24pKSl7IHVubGluayhhc3NldCgkZGF0YS0+YmlnX2ljb24pKTsgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkZGF0YS0+dXBkYXRlKCRpbnB1dCk7CgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoU3VjY2VzcygnTWVudSBjcmVhdGVkIHN1Y2Nlc3NmdWxseScpOwogICAgICAgIH1jYXRjaChcRXhjZXB0aW9uICRlKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCRlLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KCiAgICB9IAogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHNwZWNpZmllZCByZXNvdXJjZSBmcm9tIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBkZXN0cm95KCRpZCkKICAgIHsKICAgICAgICAKICAgICAgICAkZGF0YT1TdWJNZW51OjpmaW5kT3JGYWlsKCRpZCk7CiAgICAgICB0cnl7CgogICAgICAgICAgICRzdWJTdWJNZW51cz1TdWJTdWJNZW51Ojp3aGVyZUluKCdzdWJfbWVudV9pZCcsWyRpZF0pLT5kZWxldGUoKTsKCiAgICAgICAgICAgICRkYXRhLT5kZWxldGUoKTsKCiAgICAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRkYXRhLT5pY29uKSl7IHVubGluayhhc3NldCgkZGF0YS0+aWNvbikpOyAgfQogICAgICAgICAgIGlmIChmaWxlX2V4aXN0cygkZGF0YS0+YmlnX2ljb24pKXsgdW5saW5rKGFzc2V0KCRkYXRhLT5iaWdfaWNvbikpOyAgfQoKICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoU3VjY2VzcygnTWVudSBjcmVhdGVkIHN1Y2Nlc3NmdWxseScpOwoKICAgICAgIH1jYXRjaChcRXhjZXB0aW9uICRlKXsKICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJGUtPmdldE1lc3NhZ2UoKSk7CiAgICAgICB9CgogICAgfQp9Cg==