<?php
bolt_decrypt( __FILE__ , 'g5yS4d'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zXFNwYXRpZTsKCnVzZSBBcHBcSHR0cFxDb250cm9sbGVyc1xDb250cm9sbGVyOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcTWVudVxNZW51Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcTWVudVxTdWJNZW51Owp1c2UgSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3Q7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBcnRpc2FuOwp1c2UgU3BhdGllXFBlcm1pc3Npb25cTW9kZWxzXFBlcm1pc3Npb247CnVzZSBWYWxpZGF0b3I7CnVzZSBEQjsKdXNlIFlhanJhXERhdGFUYWJsZXNcRGF0YVRhYmxlczsKCmNsYXNzIEFjbFBlcm1pc3Npb25Db250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlcgp7CiAgICAvKioKICAgICAqIERpc3BsYXkgYSBsaXN0aW5nIG9mIHRoZSByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkKICAgIHsKICAgICAgICAvLyR0aGlzLT5taWRkbGV3YXJlKCdyb2xlOmRldmVsb3BlcicpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgJG1lbnVzPU1lbnU6OndoZXJlKFsnbWVudV9mb3InPT5NZW51OjpBRE1JTl9NRU5VLCdzdGF0dXMnPT5NZW51OjpBQ1RJVkVdKS0+b3JkZXJCeSgnc2VyaWFsX251bScsJ0FTQycpLT5wbHVjaygnbmFtZScsJ2lkJyk7CgogICAgICAgICR0aXRsZT0nUGVybWlzc2lvbic7CiAgICAgICAgJG1vZHVsZXMgPSBQZXJtaXNzaW9uOjp3aGVyZU5vdE51bGwoJ21vZHVsZScpLT5ncm91cEJ5KCdtb2R1bGUnKS0+cGx1Y2soJ21vZHVsZScpLT50b0FycmF5KCk7CiAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLnNwYXRpZS5wZXJtaXNzaW9uLmluZGV4Jyxjb21wYWN0KCd0aXRsZScsJ21lbnVzJywgJ21vZHVsZXMnKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaG93IHRoZSBmb3JtIGZvciBjcmVhdGluZyBhIG5ldyByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGNyZWF0ZSgpCiAgICB7CiAgICAgICAgJG1vZHVsZXMgPSBQZXJtaXNzaW9uOjp3aGVyZU5vdE51bGwoJ21vZHVsZScpLT5ncm91cEJ5KCdtb2R1bGUnKS0+cGx1Y2soJ21vZHVsZScpLT50b0FycmF5KCk7CiAgICAgICAgJGFsbERhdGE9UGVybWlzc2lvbjo6b3JkZXJCeSgnaWQnLCdERVNDJyktPnNlbGVjdCgncGVybWlzc2lvbnMuKicpOwoKICAgICAgICByZXR1cm4gRGF0YVRhYmxlczo6b2YoJGFsbERhdGEpCiAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQogICAgICAgICAgICAtPmFkZENvbHVtbignRFRfUm93SW5kZXgnLCcnKQogICAgICAgICAgICAtPmFkZENvbHVtbignYWN0aW9uJywgZnVuY3Rpb24oJHBlcm1pc3Npb24pIHVzZSgkbW9kdWxlcyl7CiAgICAgICAgICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuc3BhdGllLnBlcm1pc3Npb24uYWN0aW9uJywgY29tcGFjdCgncGVybWlzc2lvbicsICdtb2R1bGVzJykpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPnJhd0NvbHVtbnMoWydhY3Rpb24nXSkKICAgICAgICAgICAgLT50b0pzb24oKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0b3JlIGEgbmV3bHkgY3JlYXRlZCByZXNvdXJjZSBpbiBzdG9yYWdlLgogICAgICoKICAgICAqIEBwYXJhbSAgXElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0ICAkcmVxdWVzdAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzdG9yZShSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewoKICAgICAgICAkdmFsaWRhdG9yID0gVmFsaWRhdG9yOjptYWtlKCRyZXF1ZXN0LT5hbGwoKSxbCiAgICAgICAgICAgICduYW1lLionID0+ICdyZXF1aXJlZHx1bmlxdWU6cGVybWlzc2lvbnMsbmFtZScKICAgICAgICBdKTsKICAgICAgICBpZigkdmFsaWRhdG9yLT5mYWlscygpKXsKICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0KCktPmJhY2soKS0+d2l0aEVycm9ycygkdmFsaWRhdG9yKS0+d2l0aElucHV0KCk7CiAgICAgICAgfQoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeSB7Ci8vICAgICAgICAgICAgaWYoJHJlcXVlc3QtPnR5cGU9PTEpewovLyAgICAgICAgICAgICAgICBQZXJtaXNzaW9uOjpjcmVhdGVSZXNvdXJjZSgkcmVxdWVzdC0+bmFtZSwxKTsKLy8gICAgICAgICAgICB9CgogICAgICAgICAgICBmb3JlYWNoICgkcmVxdWVzdC0+bmFtZSBhcyAka2V5PT4kbmFtZSl7CiAgICAgICAgICAgICAgICBQZXJtaXNzaW9uOjpjcmVhdGUoWwogICAgICAgICAgICAgICAgICAgICduYW1lJyA9PiAkbmFtZSwKICAgICAgICAgICAgICAgICAgICAnZ3VhcmRfbmFtZScgPT4gJ3dlYicsCiAgICAgICAgICAgICAgICAgICAgJ21vZHVsZScgPT4gJHJlcXVlc3QtPm1vZHVsZQogICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgIH0KCgogICAgICAgICAgICBpZiAoIWlzX251bGwoJHJlcXVlc3QtPnN1Ym1lbnVfaWQpKXsKICAgICAgICAgICAgICAgICRzdWJNZW51PVN1Yk1lbnU6OndpdGgoJ21lbnUnKS0+ZmluZE9yRmFpbCgkcmVxdWVzdC0+c3VibWVudV9pZCk7CiAgICAgICAgICAgICAgICAkc3ViTWVudS0+bWVudS0+dXBkYXRlKFsnc2x1Zyc9Pmpzb25fZW5jb2RlKCRyZXF1ZXN0LT5uYW1lKV0pOwogICAgICAgICAgICAgICAgJHN1Yk1lbnUtPnVwZGF0ZShbJ3NsdWcnPT5qc29uX2VuY29kZSgkcmVxdWVzdC0+bmFtZSldKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZighaXNfbnVsbCgkcmVxdWVzdC0+bWVudV9pZCkpewoKICAgICAgICAgICAgICAgICRtZW51PU1lbnU6OmZpbmRPckZhaWwoJHJlcXVlc3QtPm1lbnVfaWQpLT51cGRhdGUoWydzbHVnJz0+anNvbl9lbmNvZGUoJHJlcXVlc3QtPm5hbWUpXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aFN1Y2Nlc3MoJ1Blcm1pc3Npb24gY3JlYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gJGUpIHsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkZS0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXNwbGF5IHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzaG93KCRpZCkKICAgIHsKICAgICAgICAkc3VibWVudXM9U3ViTWVudTo6d2hlcmUoWydtZW51X2lkJz0+JGlkXSktPm9yZGVyQnkoJ2lkJywnREVTQycpLT5nZXQoKTsKCiAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLnNwYXRpZS5wZXJtaXNzaW9uLnN1Ym1lbnUtbGlzdCcsY29tcGFjdCgnc3VibWVudXMnKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaG93IHRoZSBmb3JtIGZvciBlZGl0aW5nIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBlZGl0KCRpZCkKICAgIHsKICAgICAgICAkYWxsZGF0YT1QZXJtaXNzaW9uOjpwYWdpbmF0ZSgnMTAnKTsKICAgICAgICAkcGVybWlzc2lvbj1QZXJtaXNzaW9uOjpmaW5kT3JGYWlsKCRpZCk7CiAgICAgICAgJG1vZHVsZXMgPSBQZXJtaXNzaW9uOjp3aGVyZU5vdE51bGwoJ21vZHVsZScpLT5ncm91cEJ5KCdtb2R1bGUnKS0+cGx1Y2soJ21vZHVsZScpLT50b0FycmF5KCk7CiAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLnNwYXRpZS5wZXJtaXNzaW9uLmVkaXQnLGNvbXBhY3QoJ2FsbGRhdGEnLCdwZXJtaXNzaW9uJywgJ21vZHVsZXMnKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIHNwZWNpZmllZCByZXNvdXJjZSBpbiBzdG9yYWdlLgogICAgICoKICAgICAqIEBwYXJhbSAgXElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0ICAkcmVxdWVzdAogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGUoUmVxdWVzdCAkcmVxdWVzdCwgJGlkKQogICAgewoKICAgIAogICAgICAgICRkYXRhID0gUGVybWlzc2lvbjo6ZmluZE9yRmFpbCgkaWQpOwogICAgICAgICRpbnB1dCA9ICRyZXF1ZXN0LT5leGNlcHQoJ190b2tlbicpOwogICAgICAgICR2YWxpZGF0b3IgPSBWYWxpZGF0b3I6Om1ha2UoJHJlcXVlc3QtPmFsbCgpLFsKICAgICAgICAgICAgJ25hbWUnID0+ICJyZXF1aXJlZHx1bmlxdWU6cGVybWlzc2lvbnMsbmFtZSwkaWQiCgogICAgICAgIF0pOwogICAgICAgIGlmKCR2YWxpZGF0b3ItPmZhaWxzKCkpewogICAgICAgICAgICByZXR1cm4gcmVkaXJlY3QoKS0+YmFjaygpLT53aXRoRXJyb3JzKCR2YWxpZGF0b3IpLT53aXRoSW5wdXQoKTsKICAgICAgICB9CgogICAgICAgICRpbnB1dCA9ICRyZXF1ZXN0LT5hbGwoKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJGRhdGEtPnVwZGF0ZSgkaW5wdXQpOwoKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aFN1Y2Nlc3MoJ1Blcm1pc3Npb24gY3JlYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICB9IGNhdGNoIChcRXhjZXB0aW9uICRlKSB7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkZS0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CgogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UgZnJvbSBzdG9yYWdlLgogICAgICoKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveSgkaWQpCiAgICB7CiAgICAgICAgJGRhdGEgPSBQZXJtaXNzaW9uOjpmaW5kT3JGYWlsKCRpZCk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRkYXRhLT5kZWxldGUoKTsKCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhTdWNjZXNzKCdQZXJtaXNzaW9uIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgfSBjYXRjaCAoXEV4Y2VwdGlvbiAkZSkgewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJGUtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQoKICAgIH0KCgogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlUm9sZShSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgICRpbnB1dD0kcmVxdWVzdC0+ZXhjZXB0KCdfdG9rZW4nKTsKICAgICAgICAkdmFsaWRhdG9yID0gVmFsaWRhdG9yOjptYWtlKCRyZXF1ZXN0LT5hbGwoKSxbCiAgICAgICAgICAgICdyb2xlX2lkJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAncGVybWlzc2lvbl9pZCcgPT4gJ3JlcXVpcmVkJywKCiAgICAgICAgXSk7CiAgICAgICAgaWYoJHZhbGlkYXRvci0+ZmFpbHMoKSl7CiAgICAgICAgICAgIHJldHVybiByZWRpcmVjdCgpLT5iYWNrKCktPndpdGhFcnJvcnMoJHZhbGlkYXRvciktPndpdGhJbnB1dCgpOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICAgICAgREI6OnRhYmxlKCdwZXJtaXNzaW9ucycpLT53aGVyZSgncm9sZV9pZCcsJGlucHV0Wydyb2xlX2lkJ10pLT5kZWxldGUoKTsKICAgICAgICAgICAgZm9yICgkaT0wOyAkaSA8c2l6ZW9mKCRpbnB1dFsncGVybWlzc2lvbl9pZCddKSA7ICRpKyspIHsKICAgICAgICAgICAgICAgICRwZXJtaXNzaW9uSWQ9JGlucHV0WydwZXJtaXNzaW9uX2lkJ11bJGldOwogICAgICAgICAgICAgICAgXERCOjp0YWJsZSgncGVybWlzc2lvbnMnKS0+aW5zZXJ0KFsKICAgICAgICAgICAgICAgICAgICAncm9sZV9pZCc9PiRpbnB1dFsncm9sZV9pZCddLAogICAgICAgICAgICAgICAgICAgICdwZXJtaXNzaW9uX2lkJz0+JHBlcm1pc3Npb25JZAogICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgQXJ0aXNhbjo6Y2FsbCgnY2FjaGU6Y2xlYXInKTsKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoU3VjY2VzcygnUm9sZSBjcmVhdGVkIHN1Y2Nlc3NmdWxseScpOwoKICAgICAgICB9IGNhdGNoIChcRXhjZXB0aW9uICRlKSB7CiAgICAgICAgICAgIERCOjpyb2xsYmFjaygpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJGUtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQoKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gYXBwcm92YWxTZXR0aW5ncygpCiAgICB7CiAgICAgICAgZGQoJ29rJyk7CiAgICAgICAgdHJ5IHsKCiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQp9Cg==