<?php
bolt_decrypt( __FILE__ , 'DnKs7Y'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBBcHBcTW9kZWxzXEhyXFVuaXQ7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xCcmFuZDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXENhdGVnb3J5Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcQ2F0ZWdvcnlBdHRyaWJ1dGU7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xDYXRlZ29yeURlcGFydG1lbnQ7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xJbnZlbnRvcnlNb2RlbHNcSW52ZW50b3J5U3VtbWFyeTsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFByb2R1Y3Q7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllcnM7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xQcm9kdWN0VW5pdDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXEF0dHJpYnV0ZTsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFByb2R1Y3RBdHRyaWJ1dGU7CnVzZSBBcHBcTW9kZWxzXEZpeGVkQXNzZXRzXERlcHJlY2lhdGlvbk1ldGhvZDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFN0YW5kYXJkQ29zdDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFByb2R1Y3RTdGFuZGFyZENvc3Q7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xQcm9kdWN0VW5pdENvbnZlcnNpb247CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIEFwcFxJbXBvcnRzXFByb2R1Y3RJbXBvcnQ7CnVzZSBNYWF0d2Vic2l0ZVxFeGNlbFxGYWNhZGVzXEV4Y2VsOwp1c2UgREIsIERhdGFUYWJsZXM7CgpjbGFzcyBQcm9kdWN0Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKeyAgIAoKICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgIHsKICAgICAgICAkcm93cyA9ICBhcnJheSgKICAgICAgICAgICAgWydTTCcsICdTTCddLAogICAgICAgICAgICBbJ3Byb2R1Y3RfdHlwZScsICdwcm9kdWN0X3R5cGUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWyd1bml0cycsICd1bml0cyddLAogICAgICAgICAgICBbJ2NhdGVnb3J5JywgJ2NhdGVnb3J5JywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnc3ViX2NhdGVnb3J5JywgJ3N1Yl9jYXRlZ29yeScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2NvZGUnLCAnY29kZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ25hbWUnLCAnbmFtZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2F0dHJpYnV0ZXMnLCAnYXR0cmlidXRlcycsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3Byb2R1Y3RfdW5pdCcsICdwcm9kdWN0X3VuaXQnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWyd1bml0X3ByaWNlJywgJ3VuaXRfcHJpY2UnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydzYWxlc19wcmljZScsICdzYWxlc19wcmljZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2FkZGVkX2J5JywgJ2FkZGVkX2J5JywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnZmluYWxfYXNzZXQnLCAnZmluYWxfYXNzZXQnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydzZXJ2aWNlJywgJ3NlcnZpY2UnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgLy8gWydzYWxlX2l0ZW0nLCAnc2FsZV9pdGVtJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnc3RhdHVzJywgJ3N0YXR1cycsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2FjdGlvbnMnLCAnYWN0aW9ucycsICd0ZXh0LWNlbnRlciddCiAgICAgICAgKTsKCiAgICAgICAgcmV0dXJuICRyb3dzOwogICAgfQogICAgCiAgICAvKioKICAgICAqIERpc3BsYXkgYSBsaXN0aW5nIG9mIHRoZSByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGluZGV4KCkKICAgIHsKICAgICAgICB0cnkgewoKICAgICAgICAgICAgJHRpdGxlID0gKHJlcXVlc3QoKS0+aGFzKCdmaXhlZC1hc3NldHMnKSA/ICdGaXhlZCBBc3NldHMnIDogKHJlcXVlc3QoKS0+aGFzKCdjd2lwJykgPyAnQ1dJUCcgOiAnUHJvZHVjdHMnKSk7CiAgICAgICAgICAgICRwcm9kdWN0cyA9IFByb2R1Y3Q6OndpdGgoWwogICAgICAgICAgICAgICAgJ3Byb2R1Y3RVbml0JywgJ2NhdGVnb3J5LmNhdGVnb3J5JywgJ2F0dHJpYnV0ZXMuYXR0cmlidXRlT3B0aW9uLmF0dHJpYnV0ZScsICdjcmVhdG9yJywgJ21haW5Bc3NldC5hdHRyaWJ1dGVzLmF0dHJpYnV0ZU9wdGlvbi5hdHRyaWJ1dGUnLCAnc3ViQXNzZXRzLmF0dHJpYnV0ZXMuYXR0cmlidXRlT3B0aW9uLmF0dHJpYnV0ZScsICdyZXF1aXNpdGlvbkl0ZW0nCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+aGFzKCdjYXRlZ29yeScpCiAgICAgICAgICAgIC0+d2hlbighZGF0YXRhYmxlT3JkZXJpbmcoKSwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ3NrdScsICdkZXNjJyk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgJG9wdGlvbnMgPSBbCiAgICAgICAgICAgICAgICAnUHVyY2hhc2UtRGVwYXJ0bWVudCcgPT4gYXV0aCgpLT51c2VyKCktPmhhc1JvbGUoJ1B1cmNoYXNlLURlcGFydG1lbnQnKSwKICAgICAgICAgICAgICAgICdwcm9kdWN0LWVkaXQnID0+IGF1dGgoKS0+dXNlcigpLT5oYXNQZXJtaXNzaW9uVG8oJ3Byb2R1Y3QtZWRpdCcpLAogICAgICAgICAgICAgICAgJ3Byb2R1Y3QtZGVsZXRlJyA9PiBhdXRoKCktPnVzZXIoKS0+aGFzUGVybWlzc2lvblRvKCdwcm9kdWN0LWRlbGV0ZScpLAogICAgICAgICAgICAgICAgJ3Byb2R1Y3Qtc3RhbmRhcmQtY29zdHMnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgLy8gJ3Byb2R1Y3Qtc3RhbmRhcmQtY29zdHMnID0+IGF1dGgoKS0+dXNlcigpLT5oYXNQZXJtaXNzaW9uVG8oJ3Byb2R1Y3Qtc3RhbmRhcmQtY29zdHMnKSwKICAgICAgICAgICAgXTsKICAgICAgICAgICAgJHVuaXRzID0gVW5pdDo6YWxsKCk7CiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERhdGF0YWJsZXM6Om9mKCRwcm9kdWN0cykKICAgICAgICAgICAgICAgICAgICAtPmFkZEluZGV4Q29sdW1uKCkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbigncHJvZHVjdF90eXBlJywgZnVuY3Rpb24gKCRwcm9kdWN0KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRwcm9kdWN0LT5pc19maXhlZF9hc3NldCA9PSAxID8gJ0ZpeGVkIEFzc2V0JyA6ICgkcHJvZHVjdC0+aXNfY3dpcCA9PSAxID8gJ0NXSVAnIDogJ1Byb2R1Y3RzJyk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbigndW5pdHMnLCBmdW5jdGlvbigkcHJvZHVjdCkgdXNlKCR1bml0cyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkdW5pdHMtPndoZXJlSW4oJ2hyX3VuaXRfaWQnLCAkcHJvZHVjdC0+Y2F0ZWdvcnktPmNhdGVnb3J5LT5kZXBhcnRtZW50c0xpc3QtPnBsdWNrKCdkZXBhcnRtZW50LmhyX3VuaXRfaWQnKS0+dG9BcnJheSgpKS0+cGx1Y2soJ2hyX3VuaXRfc2hvcnRfbmFtZScpLT5pbXBsb2RlKCcsICcpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3VuaXRzJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2NhdGVnb3J5LmNhdGVnb3J5LmRlcGFydG1lbnRzTGlzdC5kZXBhcnRtZW50LnVuaXQnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2hyX3VuaXRfc2hvcnRfbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbigndW5pdHMnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgQ2F0ZWdvcnlEZXBhcnRtZW50OjpzZWxlY3QoJ2hyX3VuaXQuaHJfdW5pdF9zaG9ydF9uYW1lJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+am9pbignaHJfdW5pdCcsICdocl91bml0LmhyX3VuaXRfaWQnLCAnPScsICdjYXRlZ29yaWVzX2RlcGFydG1uZXQuaHJfdW5pdF9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2hyX2RlcGFydG1lbnQnLCAnaHJfZGVwYXJ0bWVudC5ocl9kZXBhcnRtZW50X2lkJywgJz0nLCAnY2F0ZWdvcmllc19kZXBhcnRtbmV0LmhyX2RlcGFydG1lbnRfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignY2F0ZWdvcmllc19kZXBhcnRtZW50LmNhdGVnb3J5X2lkJywgJ3Byb2R1Y3RzLmNhdGVnb3J5X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+dGFrZSgxKQogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2NhdGVnb3J5JywgZnVuY3Rpb24oJHByb2R1Y3QpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJHByb2R1Y3QtPmNhdGVnb3J5LT5jYXRlZ29yeS0+bmFtZSkgPyAkcHJvZHVjdC0+Y2F0ZWdvcnktPmNhdGVnb3J5LT5uYW1lIDogJyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY2F0ZWdvcnknLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnY2F0ZWdvcnkuY2F0ZWdvcnknLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ2NhdGVnb3J5JywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIENhdGVnb3J5OjpzZWxlY3QoJ21haW5fY2F0ZWdvcnkubmFtZScpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+am9pbignY2F0ZWdvcmllcyBhcyBtYWluX2NhdGVnb3J5JywgJ21haW5fY2F0ZWdvcnkuaWQnLCAnPScsICdjYXRlZ29yaWVzLnBhcmVudF9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ2NhdGVnb3JpZXMuaWQnLCAncHJvZHVjdHMuY2F0ZWdvcnlfaWQnKSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignc3ViX2NhdGVnb3J5JywgZnVuY3Rpb24oJHByb2R1Y3QpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJHByb2R1Y3QtPmNhdGVnb3J5LT5uYW1lKSA/ICRwcm9kdWN0LT5jYXRlZ29yeS0+bmFtZSA6ICcnOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3N1Yl9jYXRlZ29yeScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdjYXRlZ29yeScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignc3ViX2NhdGVnb3J5JywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIENhdGVnb3J5OjpzZWxlY3QoJ25hbWUnKS0+d2hlcmVDb2x1bW4oJ2NhdGVnb3JpZXMuaWQnLCAncHJvZHVjdHMuY2F0ZWdvcnlfaWQnKSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY29kZScsIGZ1bmN0aW9uKCRwcm9kdWN0KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRwcm9kdWN0LT5za3U7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY29kZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdza3UnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignY29kZScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlcmJ5KCdza3UnLCAkb3JkZXIpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2F0dHJpYnV0ZXMnLCBmdW5jdGlvbigkcHJvZHVjdCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkcHJvZHVjdCk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignYXR0cmlidXRlcycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdhdHRyaWJ1dGVzLmF0dHJpYnV0ZU9wdGlvbicsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC0+b3JXaGVyZUhhcygnYXR0cmlidXRlcy5hdHRyaWJ1dGVPcHRpb24uYXR0cmlidXRlJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdhdHRyaWJ1dGVzJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeSA9IHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgUHJvZHVjdEF0dHJpYnV0ZTo6c2VsZWN0KCdhdHRyaWJ1dGVzLmNvZGUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdhdHRyaWJ1dGVfb3B0aW9ucycsICdhdHRyaWJ1dGVfb3B0aW9ucy5pZCcsICc9JywgJ3Byb2R1Y3RfYXR0cmlidXRlcy5hdHRyaWJ1dGVfb3B0aW9uX2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+am9pbignYXR0cmlidXRlcycsICdhdHRyaWJ1dGVzLmlkJywgJz0nLCAnYXR0cmlidXRlX29wdGlvbnMuYXR0cmlidXRlX2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ3Byb2R1Y3RfYXR0cmlidXRlcy5wcm9kdWN0X2lkJywgJ3Byb2R1Y3RzLmlkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+dGFrZSgxKQogICAgICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5ID0gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBQcm9kdWN0QXR0cmlidXRlOjpzZWxlY3QoJ2F0dHJpYnV0ZV9vcHRpb25zLm5hbWUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdhdHRyaWJ1dGVfb3B0aW9ucycsICdhdHRyaWJ1dGVfb3B0aW9ucy5pZCcsICc9JywgJ3Byb2R1Y3RfYXR0cmlidXRlcy5hdHRyaWJ1dGVfb3B0aW9uX2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ3Byb2R1Y3RfYXR0cmlidXRlcy5wcm9kdWN0X2lkJywgJ3Byb2R1Y3RzLmlkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+dGFrZSgxKQogICAgICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdwcm9kdWN0X3VuaXQnLCBmdW5jdGlvbigkcHJvZHVjdCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkcHJvZHVjdC0+cHJvZHVjdFVuaXQtPnVuaXRfbmFtZSk/JHByb2R1Y3QtPnByb2R1Y3RVbml0LT51bml0X25hbWU6Jyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncHJvZHVjdF91bml0JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3Byb2R1Y3RVbml0JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCd1bml0X25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ3Byb2R1Y3RfdW5pdCcsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBQcm9kdWN0VW5pdDo6c2VsZWN0KCd1bml0X25hbWUnKS0+d2hlcmVDb2x1bW4oJ3Byb2R1Y3RfdW5pdHMuaWQnLCAncHJvZHVjdHMucHJvZHVjdF91bml0X2lkJykpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5lZGl0Q29sdW1uKCd1bml0X3ByaWNlJywgZnVuY3Rpb24oJHByb2R1Y3QpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3lzdGVtTW9uZXlGb3JtYXQoJHByb2R1Y3QtPnVuaXRfcHJpY2UpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2FkZGVkX2J5JywgZnVuY3Rpb24oJHByb2R1Y3QpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJHByb2R1Y3QtPmNyZWF0b3ItPm5hbWUpID8gJHByb2R1Y3QtPmNyZWF0b3ItPm5hbWUgOiAnJzsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdhZGRlZF9ieScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdjcmVhdG9yJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdhZGRlZF9ieScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBVc2VyOjpzZWxlY3QoJ25hbWUnKS0+d2hlcmVDb2x1bW4oJ3VzZXJzLmlkJywgJ3Byb2R1Y3RzLmNyZWF0ZWRfYnknKSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignbWFpbl9hc3NldCcsIGZ1bmN0aW9uKCRwcm9kdWN0KXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ2N3aXAnKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHByb2R1Y3QtPm1haW5Bc3NldCA/ICRwcm9kdWN0LT5tYWluQXNzZXQtPm5hbWUuJyAnLmdldFByb2R1Y3RBdHRyaWJ1dGVzRmFzdGVyKCRwcm9kdWN0LT5tYWluQXNzZXQpIDogJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ21haW5fYXNzZXQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnbWFpbkFzc2V0JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignc3ViX2Fzc2V0JywgZnVuY3Rpb24oJHByb2R1Y3QpewogICAgICAgICAgICAgICAgICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygnY3dpcCcpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcHJvZHVjdC0+c3ViQXNzZXRzLT5wbHVjaygnbmFtZScpLT5pbXBsb2RlKCcsICcpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdzdWJfYXNzZXQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnc3ViQXNzZXRzJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignZmluYWxfYXNzZXQnLCBmdW5jdGlvbigkcHJvZHVjdCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcHJvZHVjdC0+aXNfZmluYWxfYXNzZXQgPT0gMSA/ICAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXN1Y2Nlc3MiPlllczwvYT4nIDogJzxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1kYXJrIj5ObzwvYT4nOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3NlcnZpY2UnLCBmdW5jdGlvbiAoJHByb2R1Y3QpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHByb2R1Y3QtPmlzX3NlcnZpY2UgPT0gMSA/ICc8YSBjbGFzcz0iYnRuIGJ0bi1zdWNjZXNzIGJ0bi14cyI+WWVzPC9hPicgOiAnPGEgY2xhc3M9ImJ0biBidG4tZGFyayBidG4teHMiPk5vPC9hPic7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAvLyAtPmFkZENvbHVtbignc2FsZV9pdGVtJywgZnVuY3Rpb24gKCRwcm9kdWN0KXsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuICRwcm9kdWN0LT5pc19zYWxlX2l0ZW0gPT0gMSA/ICc8YSBjbGFzcz0iYnRuIGJ0bi1zdWNjZXNzIGJ0bi14cyI+WWVzPC9hPicgOiAnPGEgY2xhc3M9ImJ0biBidG4tZGFyayBidG4teHMiPk5vPC9hPic7CiAgICAgICAgICAgICAgICAgICAgLy8gfSkKICAgICAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3N0YXR1cycsIGZ1bmN0aW9uKCRwcm9kdWN0KSB1c2UoJG9wdGlvbnMpewogICAgICAgICAgICAgICAgICAgICAgICAkc3RhdHVzID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRwcm9kdWN0LT5zdGF0dXMgPT0gJ3BlbmRpbmcnKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRvcHRpb25zWydQdXJjaGFzZS1EZXBhcnRtZW50J10pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdGF0dXMgLj0gJzxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi13YXJuaW5nIiAgb25jbGljaz0idG9nZ2xlUHJvZHVjdCgkKHRoaXMpKSIgZGF0YS1wcm9kdWN0LWlkPSInLiRwcm9kdWN0LT5pZC4nIiBkYXRhLXN0YXR1cz0iJy4gJHByb2R1Y3QtPnN0YXR1cyAuJyIgc3R5bGU9ImN1cnNvcjogcG9pbnRlciI+UGVuZGluZzwvYT4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXR1cyAuPSAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXdhcm5pbmciICBkYXRhLXByb2R1Y3QtaWQ9IicuJHByb2R1Y3QtPmlkLiciIGRhdGEtc3RhdHVzPSInLiAkcHJvZHVjdC0+c3RhdHVzIC4nIiBzdHlsZT0iY3Vyc29yOiBwb2ludGVyIj5QZW5kaW5nPC9hPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlaWYgKCRwcm9kdWN0LT5zdGF0dXMgPT0gJ2FwcHJvdmVkJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJG9wdGlvbnNbJ1B1cmNoYXNlLURlcGFydG1lbnQnXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXR1cyAuPSAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXN1Y2Nlc3MiICBvbmNsaWNrPSJ0b2dnbGVQcm9kdWN0KCQodGhpcykpIiBkYXRhLXByb2R1Y3QtaWQ9IicuJHByb2R1Y3QtPmlkLiciIGRhdGEtc3RhdHVzPSInLiAkcHJvZHVjdC0+c3RhdHVzIC4nIiBzdHlsZT0iY3Vyc29yOiBwb2ludGVyIj5BcHByb3ZlZDwvYT4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXR1cyAuPSAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXN1Y2Nlc3MiICBkYXRhLXByb2R1Y3QtaWQ9IicuJHByb2R1Y3QtPmlkLiciIGRhdGEtc3RhdHVzPSInLiAkcHJvZHVjdC0+c3RhdHVzIC4nIiBzdHlsZT0iY3Vyc29yOiBwb2ludGVyIj5BcHByb3ZlZDwvYT4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHN0YXR1czsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhY3Rpb25zJywgZnVuY3Rpb24oJHByb2R1Y3QpIHVzZSgkb3B0aW9ucyl7CiAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb25zID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFmcmVlemVQcm9kdWN0KCRwcm9kdWN0KSB8fCBhdXRoKCktPnVzZXIoKS0+aGFzUm9sZSgnU3VwZXIgQWRtaW4nKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyAuPSAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXN1Y2Nlc3Mgcm91bmRlZC1jaXJjbGUgbWwtMiIgb25jbGljaz0idW5pdENvbnZlcnNpb25zKCQodGhpcykpIiBkYXRhLXByb2R1Y3QtaWQ9IicuJHByb2R1Y3QtPmlkLiciIHRpdGxlPSJVbml0IENvbnZlcnNpb25zIj48aSBjbGFzcz0ibGFzIGxhLXByb2plY3QtZGlhZ3JhbSI+PC9pPjwvYT4nOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb25zIC49ICc8YSBjbGFzcz0iYnRuIGJ0bi14cyBidG4tZGFyayByb3VuZGVkLWNpcmNsZSBtbC0yIiBvbmNsaWNrPSJ1cGRhdGVTdXBwbGllcnMoJCh0aGlzKSkiIGRhdGEtcHJvZHVjdC1pZD0iJy4kcHJvZHVjdC0+aWQuJyIgdGl0bGU9IlVwZGF0ZSBTdXBwbGllcnMiPjxpIGNsYXNzPSJsYXMgbGEtdXNlcnMiPjwvaT48L2E+JzsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdXJsID0gcm91dGUoJ3Btcy5wcm9kdWN0LW1hbmFnZW1lbnQucHJvZHVjdC5lZGl0JywgJHByb2R1Y3QtPmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+aGFzKCdmaXhlZC1hc3NldHMnKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVybCA9IHVybCgncG1zL2ZpeGVkLWFzc2V0cy9wcm9kdWN0L2VkaXQvJy4kcHJvZHVjdC0+aWQpLic/Zml4ZWQtYXNzZXRzJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlaWYocmVxdWVzdCgpLT5oYXMoJ2N3aXAnKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVybCA9IHVybCgncG1zL2N3aXAvcHJvZHVjdC8nLiRwcm9kdWN0LT5pZC4nL2VkaXQnKS4nP2N3aXAnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRvcHRpb25zWydwcm9kdWN0LWVkaXQnXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGlvbnMgLj0gJzxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1pbmZvIHJvdW5kZWQtY2lyY2xlIG1sLTIiIGhyZWY9IicuJHVybC4nIj48aSBjbGFzcz0ibGEgbGEtZWRpdCI+PC9pPjwvYT4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRvcHRpb25zWydwcm9kdWN0LWRlbGV0ZSddICYmICFmcmVlemVQcm9kdWN0KCRwcm9kdWN0KSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGlvbnMgLj0gJzxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1kYW5nZXIgbWwtMiIgb25jbGljaz0iZGVsZXRlRnJvbUNSVUQoJCh0aGlzKSkiIGRhdGEtc3JjPSInLnJvdXRlKCdwbXMucHJvZHVjdC1tYW5hZ2VtZW50LnByb2R1Y3QuZGVzdHJveScsICRwcm9kdWN0LT5pZCkuJyI+PGkgY2xhc3M9ImxhIGxhLXRyYXNoIj48L2k+PC9hPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJG9wdGlvbnNbJ3Byb2R1Y3Qtc3RhbmRhcmQtY29zdHMnXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGlvbnMgLj0gJzxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1zdWNjZXNzIG1sLTIgbXQtMSIgaHJlZj0iJy51cmwoJ3Btcy9wcm9kdWN0LW1hbmFnZW1lbnQvcHJvZHVjdC8nLiRwcm9kdWN0LT5pZC4nL3N0YW5kYXJkLWNvc3RzJykuJyI+PGkgY2xhc3M9ImxhIGxhLXRhc2tzIj48L2k+PC9hPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkYWN0aW9uczsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+cmF3Q29sdW1ucyhbJ3N0YXR1cycsICdhY3Rpb25zJywgJ2ZpbmFsX2Fzc2V0JywgJ3NlcnZpY2UnLCAnc2FsZV9pdGVtJ10pCiAgICAgICAgICAgICAgICAgICAgLT5tYWtlKHRydWUpOwogICAgICAgICAgICB9CgoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLnByb2R1Y3RzLmluZGV4JywgWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiR0aXRsZSwKICAgICAgICAgICAgICAgICdoZWFkZXJDb2x1bW5zJyA9PiAkdGhpcy0+aGVhZGVyQ29sdW1ucygpCiAgICAgICAgICAgIF0pOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCgogICAgLyoqCiAgICAgKiBTaG93IHRoZSBmb3JtIGZvciBjcmVhdGluZyBhIG5ldyByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGNyZWF0ZSgpCiAgICB7CiAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ2dldC1zdWItY2F0ZWdvcmllcycpKXsKICAgICAgICAgICAgcmV0dXJuIGNhdGVnb3J5T3B0aW9ucyhbXSwgcmVxdWVzdCgpLT5nZXQoJ2Nob3NlbicpLCAwLCByZXF1ZXN0KCktPmhhcygnZml4ZWRfYXNzZXQnKSwgcmVxdWVzdCgpLT5oYXMoJ2N3aXAnKSk7CiAgICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgICAkcHJlZml4ID0gZGF0ZSgneW0nLCBzdHJ0b3RpbWUoZGF0ZSgnWS1tLWQnKSkpOwogICAgICAgICAgICAkc2t1ID0gdW5pcXVlQ29kZSgxMiwgJHByZWZpeCwgJ3Byb2R1Y3RzJywgJ2lkJyk7CgogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJ05ldyBQcm9kdWN0JywKICAgICAgICAgICAgICAgICdzdXBwbGllcnMnID0+IFN1cHBsaWVyczo6d2hlcmUoJ3N0YXR1cycsICdBY3RpdmUnKS0+cGx1Y2soJ25hbWUnLCdpZCcpLT5hbGwoKSwKICAgICAgICAgICAgICAgICdicmFuZHMnID0+IEJyYW5kOjpwbHVjaygnbmFtZScsJ2lkJyktPmFsbCgpLAogICAgICAgICAgICAgICAgJ3VuaXQnID0+IFByb2R1Y3RVbml0OjpwbHVjaygndW5pdF9uYW1lJywnaWQnKS0+YWxsKCksCiAgICAgICAgICAgICAgICAnc2t1JyA9PiAkc2t1LAogICAgICAgICAgICAgICAgJ2F0dHJpYnV0ZXMnID0+IEF0dHJpYnV0ZTo6d2l0aCgnb3B0aW9ucycpLT5nZXQoKSwKICAgICAgICAgICAgICAgICdhY2NvdW50cycgPT4gY2hhcnRPZkFjY291bnRzT3B0aW9ucyhbXSwgMCwgMCwgW10pLAogICAgICAgICAgICAgICAgJ2RlcHJlY2lhdGlvbk1ldGhvZHMnID0+IGNhbGxNb2R1bGVBcGkoJ2ZpbmFuY2UnLCAnZGVwcmVjaWF0aW9uLW1ldGhvZHMnLCBbCiAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gMQogICAgICAgICAgICAgICAgXSlbJ2RhdGEnXSwKICAgICAgICAgICAgICAgICdjYXRlZ29yeU9wdGlvbnMnID0+IGNhdGVnb3J5T3B0aW9ucyhbXSwgMCwgMCwgLTEsIC0xKQogICAgICAgICAgICBdOwoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLnByb2R1Y3RzLmNyZWF0ZScsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTdG9yZSBhIG5ld2x5IGNyZWF0ZWQgcmVzb3VyY2UgaW4gc3RvcmFnZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIFxJbGx1bWluYXRlXEh0dHBcUmVxdWVzdCAgJHJlcXVlc3QKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RvcmUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkdGhpcy0+dmFsaWRhdGUoJHJlcXVlc3QsIFsKICAgICAgICAgICAgJ25hbWUnID0+IFsncmVxdWlyZWQnLCAnc3RyaW5nJywgJ21heDoyNTUnXSwKICAgICAgICAgICAgJ2NhdGVnb3J5X2lkJyA9PiBbJ3JlcXVpcmVkJywgJ3N0cmluZycsICdtYXg6MjU1J10sCiAgICAgICAgICAgICdwcm9kdWN0X3VuaXRfaWQnID0+IFsncmVxdWlyZWQnLCAnc3RyaW5nJywgJ21heDoyNTUnXSwKICAgICAgICAgICAgLy8gJ3RheCcgPT4gWydyZXF1aXJlZCcsICdyZWdleDovXlxkKihcLlxkezEsMn0pPyQvJ10sCiAgICAgICAgICAgICd2YXQnID0+IFsncmVxdWlyZWQnLCAncmVnZXg6L15cZCooXC5cZHsxLDJ9KT8kLyddLAogICAgICAgICAgICAndW5pdF9wcmljZScgPT4gWydyZXF1aXJlZCcsICdyZWdleDovXlxkKihcLlxkezEsMn0pPyQvJ10sCiAgICAgICAgICAgIC8vICdzYWxlc19wcmljZScgPT4gWydyZXF1aXJlZCcsICdyZWdleDovXlxkKihcLlxkezEsMn0pPyQvJ10sCiAgICAgICAgICAgICdza3UnID0+IFsncmVxdWlyZWQnXSwKICAgICAgICAgICAgLy8gJ3N1cHBsaWVyJyA9PiBbJ3JlcXVpcmVkJ10sCiAgICAgICAgXSk7CgogICAgICAgIGlmKGF1dGgoKS0+dXNlcigpLT5oYXNQZXJtaXNzaW9uVG8oJ3Byb2R1Y3QtZmluYW5jZS1pbmZvcm1hdGlvbicpKXsKICAgICAgICAgICAgJHRoaXMtPnZhbGlkYXRlKCRyZXF1ZXN0LCBbCiAgICAgICAgICAgICAgICAnaW52ZW50b3J5X2FjY291bnRfaWQnID0+IFsncmVxdWlyZWQnXSwKICAgICAgICAgICAgICAgICdpbnZlbnRvcnlfYWRqdXN0bWVudHNfYWNjb3VudF9pZCcgPT4gWydyZXF1aXJlZCddLAogICAgICAgICAgICBdKTsKICAgICAgICB9CgogICAgICAgIERCOjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJ5IHsKCiAgICAgICAgICAgIGlmKGlzc2V0KCRyZXF1ZXN0LT5wYXJlbnRfaWQpICYmICRyZXF1ZXN0LT5wYXJlbnRfaWQgPiAwKXsKICAgICAgICAgICAgICAgICRwYXJlbnQgPSBQcm9kdWN0OjpmaW5kT3JGYWlsKCRyZXF1ZXN0LT5wYXJlbnRfaWQpOwogICAgICAgICAgICAgICAgaWYoJHJlcXVlc3QtPnllYXJzID4gJHBhcmVudC0+eWVhcnMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIlN1YiBBc3NldHMgbGlmZSBkdXJhdGlvbiAoIi4kcmVxdWVzdC0+eWVhcnMuIikgY2Fubm90IGJlIGdyYXRlciB0aGFuIE1haW4gQXNzZXQgbGlmZSBkdXJhdGlvbiAoIi4kcGFyZW50LT55ZWFycy4iKSIsCiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgICRzdXBwbGllcnMgPSBpc3NldCgkcmVxdWVzdC0+c3VwcGxpZXIpID8gJHJlcXVlc3QtPnN1cHBsaWVyIDogW107CiAgICAgICAgICAgICRidWZmZXJJbnZlbnRvcnkgPSAkcmVxdWVzdC0+YnVmZmVyX2ludmVudG9yeTsKICAgICAgICAgICAgJGlucHV0cyA9ICRyZXF1ZXN0LT5hbGwoKTsKICAgICAgICAgICAgdW5zZXQoJGlucHV0c1snX3Rva2VuJ10pOwogICAgICAgICAgICB1bnNldCgkaW5wdXRzWydfbWV0aG9kJ10pOwogICAgICAgICAgICB1bnNldCgkaW5wdXRzWydzdXBwbGllciddKTsKICAgICAgICAgICAgdW5zZXQoJGlucHV0c1snYnVmZmVyX2ludmVudG9yeSddKTsKCiAgICAgICAgICAgICRpbnB1dHNbJ2lzX2ZpeGVkX2Fzc2V0J10gPSAwOwogICAgICAgICAgICAkaW5wdXRzWydpc19jd2lwJ10gPSAwOwogICAgICAgICAgICBpZigkcmVxdWVzdC0+cHJvZHVjdF90eXBlID09ICdmaXhlZF9hc3NldCcpewogICAgICAgICAgICAgICAgJGlucHV0c1snaXNfZml4ZWRfYXNzZXQnXSA9IDE7CiAgICAgICAgICAgICAgICAkaW5wdXRzWydpc19jd2lwJ10gPSAwOwogICAgICAgICAgICB9ZWxzZWlmKCRyZXF1ZXN0LT5wcm9kdWN0X3R5cGUgPT0gJ2N3aXAnKXsKICAgICAgICAgICAgICAgICRpbnB1dHNbJ2lzX2ZpeGVkX2Fzc2V0J10gPSAwOwogICAgICAgICAgICAgICAgJGlucHV0c1snaXNfY3dpcCddID0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJHByb2R1Y3QgPSBQcm9kdWN0OjpjcmVhdGUoJGlucHV0cyk7CiAgICAgICAgICAgIC8vICRwcm9kdWN0LT5zdXBwbGllcnMoKS0+c3luYyhpc3NldCgkc3VwcGxpZXJzWzBdKSA/ICRzdXBwbGllcnMgOiBbXSk7CiAgICAgICAgICAgIGlmICgkYnVmZmVySW52ZW50b3J5KXsKICAgICAgICAgICAgICAgICRpbnZlbnRvcnlTdW1tYXJ5ID0gbmV3IEludmVudG9yeVN1bW1hcnkoKTsKICAgICAgICAgICAgICAgICRpbnZlbnRvcnlTdW1tYXJ5LT5jYXRlZ29yeV9pZCA9ICRpbnB1dHNbJ2NhdGVnb3J5X2lkJ107CiAgICAgICAgICAgICAgICAkaW52ZW50b3J5U3VtbWFyeS0+cHJvZHVjdF9pZCA9ICRwcm9kdWN0LT5pZDsKICAgICAgICAgICAgICAgICRpbnZlbnRvcnlTdW1tYXJ5LT5idWZmZXJfaW52ZW50b3J5ID0gJGJ1ZmZlckludmVudG9yeTsKICAgICAgICAgICAgICAgICRpbnZlbnRvcnlTdW1tYXJ5LT5zYXZlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKGlzc2V0KCRyZXF1ZXN0LT5wcm9kdWN0QXR0cmlidXRlc1swXSkpewogICAgICAgICAgICAgICAgZm9yZWFjaCgkcmVxdWVzdC0+cHJvZHVjdEF0dHJpYnV0ZXMgYXMgJGtleSA9PiAkYXR0cmlidXRlX2lkKXsKICAgICAgICAgICAgICAgICAgICAkc2VyaWFsX25vID0gQ2F0ZWdvcnlBdHRyaWJ1dGU6OndoZXJlKFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2NhdGVnb3J5X2lkJyA9PiAkcmVxdWVzdC0+Y2F0ZWdvcnlfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdhdHRyaWJ1dGVfaWQnID0+ICRhdHRyaWJ1dGVfaWQKICAgICAgICAgICAgICAgICAgICBdKS0+c3VtKCdzZXJpYWwnKTsKICAgICAgICAgICAgICAgICAgICBpZihpc3NldCgkcmVxdWVzdC0+YXR0cmlidXRlX29wdGlvbl9pZFskYXR0cmlidXRlX2lkXSkgJiYgJHJlcXVlc3QtPmF0dHJpYnV0ZV9vcHRpb25faWRbJGF0dHJpYnV0ZV9pZF0gIT0gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgIFByb2R1Y3RBdHRyaWJ1dGU6OmNyZWF0ZShbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncHJvZHVjdF9pZCcgPT4gJHByb2R1Y3QtPmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2F0dHJpYnV0ZV9vcHRpb25faWQnID0+ICRyZXF1ZXN0LT5hdHRyaWJ1dGVfb3B0aW9uX2lkWyRhdHRyaWJ1dGVfaWRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NlcmlhbF9ubycgPT4gJHNlcmlhbF9ubywKICAgICAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkcHJvZHVjdEF0dHJpYnV0ZXMgPSBnZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkcHJvZHVjdCk7CgogICAgICAgICAgICAkcHJvZHVjdHMgPSBQcm9kdWN0Ojp3aXRoKFsKICAgICAgICAgICAgICAgICdhdHRyaWJ1dGVzLmF0dHJpYnV0ZU9wdGlvbi5hdHRyaWJ1dGUnCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmUoWwogICAgICAgICAgICAgICAgWydpZCcsICchPScsICRwcm9kdWN0LT5pZF0sCiAgICAgICAgICAgICAgICBbJ25hbWUnLCAkcHJvZHVjdC0+bmFtZV0sCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2F0dHJpYnV0ZXMnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRwcm9kdWN0KSB7CiAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlSW4oJ2F0dHJpYnV0ZV9vcHRpb25faWQnLCAkcHJvZHVjdC0+YXR0cmlidXRlcy0+cGx1Y2soJ2F0dHJpYnV0ZV9vcHRpb25faWQnKS0+dG9BcnJheSgpKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT5nZXQoKTsKICAgICAgICAgICAgJGNvdW50ID0gMDsKICAgICAgICAgICAgaWYoaXNzZXQoJHByb2R1Y3RzWzBdKSl7CiAgICAgICAgICAgICAgICBmb3JlYWNoKCRwcm9kdWN0cyBhcyAka2V5ID0+ICR0aGlzX3Byb2R1Y3QpewogICAgICAgICAgICAgICAgICAgIGlmKCRwcm9kdWN0QXR0cmlidXRlcyA9PSBnZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkdGhpc19wcm9kdWN0KSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGhpc19wcm9kdWN0LT5uYW1lLicgJy5nZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkdGhpc19wcm9kdWN0KS4nIGFscmVhZHkgZXhpc3RzIScsCiAgICAgICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJG1lc3NhZ2UgPSAnPHNwYW4gY2xhc3M9Im5vdGlmaWNhdGlvbi1saW5rcyIgZGF0YS1zcmM9IicudXJsKCdwbXMvcHJvZHVjdC1tYW5hZ2VtZW50L3Byb2R1Y3QvJy4kcHJvZHVjdC0+aWQuJy9kZXRhaWxzJykuJyIgZGF0YS10aXRsZT0iUHJvZHVjdCBEZXRhaWxzIj5Qcm9kdWN0ICcuJHByb2R1Y3QtPm5hbWUuJyAnLiRwcm9kdWN0QXR0cmlidXRlcy4nIGlzIHdhaXRpbmcgZm9yIGFwcHJvdmFsLjwvc3Bhbj4nOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIENyZWF0ZU9yVXBkYXRlTm90aWZpY2F0aW9uKCRtZXNzYWdlLCd1bnJlYWQnLCcnLGdldE1hbmFnZXJJbmZvKCdQdXJjaGFzZS1EZXBhcnRtZW50JywgbnVsbCwgdHJ1ZSksJ3NlbmQtdG8tcHVyY2hhc2UtZGVwYXJ0bWVudCcpOwoKCiAgICAgICAgICAgIC8vIHVwZGF0ZVN1cHBsaWVyUHJvZHVjdHMoMTIpOwogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CgogICAgICAgICAgICAkcHJlZml4ID0gZGF0ZSgneW0nLCBzdHJ0b3RpbWUoZGF0ZSgnWS1tLWQnKSkpOwogICAgICAgICAgICAkc2t1ID0gdW5pcXVlQ29kZSgxMiwgJHByZWZpeCwgJ3Byb2R1Y3RzJywgJ2lkJyk7CgogICAgICAgICAgICBpZigkcmVxdWVzdC0+d2hlcmVfdG9fZ28gPT0gJ3NhdmUnKXsKICAgICAgICAgICAgICAgIHNlc3Npb24oKS0+Zmxhc2goJ2FsZXJ0LXR5cGUnLCAnc3VjY2VzcycpOwogICAgICAgICAgICAgICAgc2Vzc2lvbigpLT5mbGFzaCgnbWVzc2FnZScsICJQcm9kdWN0IGhhcyBiZWVuIGFkZGVkIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICduZXcnID0+ICgkcmVxdWVzdC0+d2hlcmVfdG9fZ28gPT0gJ3NhdmUtYW5kLW5ldycpLAogICAgICAgICAgICAgICAgJ3NrdScgPT4gJHNrdSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAiUHJvZHVjdCBoYXMgYmVlbiBhZGRlZCBzdWNjZXNzZnVsbHkiLAogICAgICAgICAgICBdKTsKCiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIERCOjpyb2xsYmFjaygpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gJHRoLT5nZXRNZXNzYWdlKCksCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIERpc3BsYXkgdGhlIHNwZWNpZmllZCByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHNob3coUHJvZHVjdCAkcHJvZHVjdCkKICAgIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkcHJvZHVjdC0+c3JjID0gcm91dGUoJ3Btcy5wcm9kdWN0LW1hbmFnZW1lbnQucHJvZHVjdC51cGRhdGUnLCRwcm9kdWN0LT5pZCk7CiAgICAgICAgICAgICRwcm9kdWN0LT5yZXFfdHlwZSA9ICdwdXQnOwogICAgICAgICAgICAkc3VwcGxpZXJzID0gW107CiAgICAgICAgICAgIGZvcmVhY2ggKCRwcm9kdWN0LT5zdXBwbGllcnMgYXMgJHN1cHBsaWVyKXsKICAgICAgICAgICAgICAgICRzdXBwbGllcnNbXSA9ICRzdXBwbGllci0+aWQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRwcm9kdWN0LT5zdXBwbGllciA9ICRzdXBwbGllcnM7CiAgICAgICAgICAgICRwcm9kdWN0LT5idWZmZXJfaW52ZW50b3J5ID0gJHByb2R1Y3QtPnJlbEludmVudG9yeVN1bW1hcnk/JHByb2R1Y3QtPnJlbEludmVudG9yeVN1bW1hcnktPmJ1ZmZlcl9pbnZlbnRvcnk6bnVsbDsKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAnc3RhdHVzJyA9PiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICAnaW5mbycgPT4gJHByb2R1Y3QKICAgICAgICAgICAgXTsKCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAnc3RhdHVzJyA9PiBudWxsLAogICAgICAgICAgICAgICAgJ2luZm8nID0+ICR0aC0+Z2V0TWVzc2FnZSgpCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCRkYXRhKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTaG93IHRoZSBmb3JtIGZvciBlZGl0aW5nIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBlZGl0KCRpZCkKICAgIHsKICAgICAgICAkcHJvZHVjdCA9IFByb2R1Y3Q6OndpdGgoWwogICAgICAgICAgICAnYXR0cmlidXRlcy5hdHRyaWJ1dGVPcHRpb24uYXR0cmlidXRlJywKICAgICAgICAgICAgJ3N1cHBsaWVycycKICAgICAgICBdKS0+ZmluZE9yRmFpbCgkaWQpOwogICAgICAgIGlmKGZyZWV6ZVByb2R1Y3QoJHByb2R1Y3QpICYmICFhdXRoKCktPnVzZXIoKS0+aGFzUm9sZSgnU3VwZXIgQWRtaW4nKSl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigiUHJvZHVjdCAjIi4kcHJvZHVjdC0+bmFtZS4iICIuZ2V0UHJvZHVjdEF0dHJpYnV0ZXNGYXN0ZXIoJHByb2R1Y3QpLiIgQ2Fubm90IEJlIEVkaXRlZCEiKTsKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRjYXRlZ29yeUF0dHJpYnV0ZXMgPSBDYXRlZ29yeUF0dHJpYnV0ZTo6d2hlcmUoJ2NhdGVnb3J5X2lkJywgJHByb2R1Y3QtPmNhdGVnb3J5X2lkKS0+Z2V0KCk7CiAgICAgICAgICAgICRhdHRyaWJ1dGVzID0gW107CiAgICAgICAgICAgICRhdHRyaWJ1dGVPcHRpb25zID0gW107CiAgICAgICAgICAgIGlmKGlzc2V0KCRjYXRlZ29yeUF0dHJpYnV0ZXNbMF0pKXsKICAgICAgICAgICAgICAgIGZvcmVhY2goJGNhdGVnb3J5QXR0cmlidXRlcyBhcyAka2V5ID0+ICRjYXRlZ29yeUF0dHJpYnV0ZSl7CiAgICAgICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkYXR0cmlidXRlcywgJGNhdGVnb3J5QXR0cmlidXRlLT5hdHRyaWJ1dGVfaWQpOwogICAgICAgICAgICAgICAgICAgICRhdHRyaWJ1dGVPcHRpb25zID0gYXJyYXlfbWVyZ2UoJGF0dHJpYnV0ZU9wdGlvbnMsIChpc19hcnJheShqc29uX2RlY29kZSgkY2F0ZWdvcnlBdHRyaWJ1dGUtPm9wdGlvbnMsIHRydWUpKSA/IGpzb25fZGVjb2RlKCRjYXRlZ29yeUF0dHJpYnV0ZS0+b3B0aW9ucywgdHJ1ZSkgOiBbXSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJ0VkaXQgUHJvZHVjdCcsCiAgICAgICAgICAgICAgICAnY2F0ZWdvcmllcycgPT4gQ2F0ZWdvcnk6OmFsbCgpLAogICAgICAgICAgICAgICAgJ3N1cHBsaWVycycgPT4gU3VwcGxpZXJzOjp3aGVyZSgnc3RhdHVzJywgJ0FjdGl2ZScpLT5nZXQoWydpZCcsICduYW1lJ10pLAogICAgICAgICAgICAgICAgJ2JyYW5kcycgPT4gQnJhbmQ6OnBsdWNrKCduYW1lJywnaWQnKS0+YWxsKCksCiAgICAgICAgICAgICAgICAndW5pdCcgPT4gUHJvZHVjdFVuaXQ6OnBsdWNrKCd1bml0X25hbWUnLCdpZCcpLT5hbGwoKSwKICAgICAgICAgICAgICAgICdhdHRyaWJ1dGVzJyA9PiBBdHRyaWJ1dGU6OndpdGgoJ29wdGlvbnMnKS0+Z2V0KCksCiAgICAgICAgICAgICAgICAncHJvZHVjdCcgPT4gJHByb2R1Y3QsCiAgICAgICAgICAgICAgICAncHJvZHVjdEF0dHJpYnV0ZXMnID0+ICRwcm9kdWN0LT5hdHRyaWJ1dGVzLT5wbHVjaygnYXR0cmlidXRlT3B0aW9uLmF0dHJpYnV0ZV9pZCcpLT50b0FycmF5KCksCiAgICAgICAgICAgICAgICAnZXhpc3RlZFN1cHBsaWVycycgPT4gJHByb2R1Y3QtPnN1cHBsaWVycy0+cGx1Y2soJ3Bpdm90LnN1cHBsaWVyX2lkJyktPnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgICdjYXRlZ29yeU9wdGlvbnMnID0+IGNhdGVnb3J5T3B0aW9ucyhbXSwgJHByb2R1Y3QtPmNhdGVnb3J5X2lkLCAwLCAtMSwgLTEpLAogICAgICAgICAgICAgICAgJ2NhdGVnb3J5QXR0cmlidXRlcycgPT4gJGF0dHJpYnV0ZXMsCiAgICAgICAgICAgICAgICAnY2F0ZWdvcnlBdHRyaWJ1dGVPcHRpb25zJyA9PiAkYXR0cmlidXRlT3B0aW9ucywKCiAgICAgICAgICAgICAgICAnY2hhcnRPZkFjY291bnRzT3B0aW9ucycgPT4gY2hhcnRPZkFjY291bnRzT3B0aW9ucyhbXSwgMCwgMCwgW10pLAogICAgICAgICAgICAgICAgJ2RlcHJlY2lhdGlvbk1ldGhvZHMnID0+IGNhbGxNb2R1bGVBcGkoJ2ZpbmFuY2UnLCAnZGVwcmVjaWF0aW9uLW1ldGhvZHMnLCBbCiAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gMQogICAgICAgICAgICAgICAgXSlbJ2RhdGEnXSwKICAgICAgICAgICAgICAgICdjYXRlZ29yeV90eXBlJyA9PiAoJHByb2R1Y3QtPmNhdGVnb3J5LT5pc19maXhlZF9hc3NldCA9PSAxID8gJ2ZpeGVkX2Fzc2V0JyA6ICgkcHJvZHVjdC0+Y2F0ZWdvcnktPmlzX2N3aXAgPT0gMSA/ICdjd2lwJyA6ICdwcm9kdWN0cycpKSwKICAgICAgICAgICAgICAgICdwcm9kdWN0X3R5cGUnID0+ICgkcHJvZHVjdC0+aXNfZml4ZWRfYXNzZXQgPT0gMSA/ICdmaXhlZF9hc3NldCcgOiAoJHByb2R1Y3QtPmlzX2N3aXAgPT0gMSA/ICdjd2lwJyA6ICdwcm9kdWN0cycpKSwKICAgICAgICAgICAgXTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiB2aWV3KCdwbXMuYmFja2VuZC5wYWdlcy5wcm9kdWN0cy5lZGl0JywgJGRhdGEpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgc3BlY2lmaWVkIHJlc291cmNlIGluIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3QgICRyZXF1ZXN0CiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCBQcm9kdWN0ICRwcm9kdWN0KQogICAgewogICAgICAgIGlmKCFhdXRoKCktPnVzZXIoKS0+aGFzUm9sZSgnRW1wbG95ZWUnKSl7CiAgICAgICAgICAgICR0aGlzLT52YWxpZGF0ZSgkcmVxdWVzdCwgWwogICAgICAgICAgICAgICAgJ3NrdScgPT4gWydyZXF1aXJlZCddLAogICAgICAgICAgICAgICAgJ25hbWUnID0+IFsncmVxdWlyZWQnLCAnc3RyaW5nJywgJ21heDoyNTUnXSwKICAgICAgICAgICAgICAgICdjYXRlZ29yeV9pZCcgPT4gWydyZXF1aXJlZCcsICdzdHJpbmcnLCAnbWF4OjI1NSddLAogICAgICAgICAgICBdKTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT52YWxpZGF0ZSgkcmVxdWVzdCwgWwogICAgICAgICAgICAncHJvZHVjdF91bml0X2lkJyA9PiBbJ3JlcXVpcmVkJywgJ3N0cmluZycsICdtYXg6MjU1J10sCiAgICAgICAgICAgICd1bml0X3ByaWNlJyA9PiBbJ3JlcXVpcmVkJywgJ3JlZ2V4Oi9eXGQqKFwuXGR7MSwyfSk/JC8nXSwKICAgICAgICAgICAgLy8gJ3NhbGVzX3ByaWNlJyA9PiBbJ3JlcXVpcmVkJywgJ3JlZ2V4Oi9eXGQqKFwuXGR7MSwyfSk/JC8nXSwKICAgICAgICAgICAgLy8gJ3RheCcgPT4gWydyZXF1aXJlZCcsICdyZWdleDovXlxkKihcLlxkezEsMn0pPyQvJ10sCiAgICAgICAgICAgICd2YXQnID0+IFsncmVxdWlyZWQnLCAncmVnZXg6L15cZCooXC5cZHsxLDJ9KT8kLyddLAogICAgICAgICAgICAvLyAnc3VwcGxpZXInID0+IFsncmVxdWlyZWQnXSwKICAgICAgICBdKTsKCiAgICAgICAgaWYoYXV0aCgpLT51c2VyKCktPmhhc1Blcm1pc3Npb25UbygncHJvZHVjdC1maW5hbmNlLWluZm9ybWF0aW9uJykpewogICAgICAgICAgICAkdGhpcy0+dmFsaWRhdGUoJHJlcXVlc3QsIFsKICAgICAgICAgICAgICAgICdpbnZlbnRvcnlfYWNjb3VudF9pZCcgPT4gWydyZXF1aXJlZCddLAogICAgICAgICAgICAgICAgLy8gJ2NvZ3NfYWNjb3VudF9pZCcgPT4gWydyZXF1aXJlZCddLAogICAgICAgICAgICAgICAgJ2ludmVudG9yeV9hZGp1c3RtZW50c19hY2NvdW50X2lkJyA9PiBbJ3JlcXVpcmVkJ10sCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KCiAgICAgICAgaWYoZnJlZXplUHJvZHVjdCgkcHJvZHVjdCkgJiYgIWF1dGgoKS0+dXNlcigpLT5oYXNSb2xlKCdTdXBlciBBZG1pbicpKXsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJQcm9kdWN0ICMiLiRwcm9kdWN0LT5uYW1lLiIgIi5nZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkcHJvZHVjdCkuIiBDYW5ub3QgQmUgRWRpdGVkISIKICAgICAgICAgICAgXSk7CiAgICAgICAgfQoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmKGlzc2V0KCRyZXF1ZXN0LT5wYXJlbnRfaWQpICYmICRyZXF1ZXN0LT5wYXJlbnRfaWQgPiAwKXsKICAgICAgICAgICAgICAgICRwYXJlbnQgPSBQcm9kdWN0OjpmaW5kT3JGYWlsKCRyZXF1ZXN0LT5wYXJlbnRfaWQpOwogICAgICAgICAgICAgICAgaWYoJHJlcXVlc3QtPnllYXJzID4gJHBhcmVudC0+eWVhcnMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIlN1YiBBc3NldHMgbGlmZSBkdXJhdGlvbiAoIi4kcmVxdWVzdC0+eWVhcnMuIikgY2Fubm90IGJlIGdyYXRlciB0aGFuIE1haW4gQXNzZXQgbGlmZSBkdXJhdGlvbiAoIi4kcGFyZW50LT55ZWFycy4iKSIKICAgICAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJHN1cHBsaWVycyA9IGlzc2V0KCRyZXF1ZXN0LT5zdXBwbGllcikgPyAkcmVxdWVzdC0+c3VwcGxpZXIgOiBbXTsKICAgICAgICAgICAgJGJ1ZmZlckludmVudG9yeSA9ICRyZXF1ZXN0LT5idWZmZXJfaW52ZW50b3J5OwogICAgICAgICAgICAkaW5wdXRzID0gJHJlcXVlc3QtPmFsbCgpOwogICAgICAgICAgICB1bnNldCgkaW5wdXRzWydfdG9rZW4nXSk7CiAgICAgICAgICAgIHVuc2V0KCRpbnB1dHNbJ19tZXRob2QnXSk7CiAgICAgICAgICAgIHVuc2V0KCRpbnB1dHNbJ3N1cHBsaWVyJ10pOwogICAgICAgICAgICB1bnNldCgkaW5wdXRzWydidWZmZXJfaW52ZW50b3J5J10pOwoKICAgICAgICAgICAgJGlucHV0c1snaXNfZml4ZWRfYXNzZXQnXSA9IDA7CiAgICAgICAgICAgICRpbnB1dHNbJ2lzX2N3aXAnXSA9IDA7CiAgICAgICAgICAgIGlmKCRyZXF1ZXN0LT5wcm9kdWN0X3R5cGUgPT0gJ2ZpeGVkX2Fzc2V0Jyl7CiAgICAgICAgICAgICAgICAkaW5wdXRzWydpc19maXhlZF9hc3NldCddID0gMTsKICAgICAgICAgICAgICAgICRpbnB1dHNbJ2lzX2N3aXAnXSA9IDA7CiAgICAgICAgICAgIH1lbHNlaWYoJHJlcXVlc3QtPnByb2R1Y3RfdHlwZSA9PSAnY3dpcCcpewogICAgICAgICAgICAgICAgJGlucHV0c1snaXNfZml4ZWRfYXNzZXQnXSA9IDA7CiAgICAgICAgICAgICAgICAkaW5wdXRzWydpc19jd2lwJ10gPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkcHJvZHVjdC0+dXBkYXRlKCRpbnB1dHMpOwogICAgICAgICAgICAvLyAkcHJvZHVjdC0+c3VwcGxpZXJzKCktPnN5bmMoaXNzZXQoJHN1cHBsaWVyc1swXSkgPyAkc3VwcGxpZXJzIDogW10pOwogICAgICAgICAgICBpZiAoJGJ1ZmZlckludmVudG9yeSl7CiAgICAgICAgICAgICAgICBpZiAoJHByb2R1Y3QtPnJlbEludmVudG9yeVN1bW1hcnkpewogICAgICAgICAgICAgICAgICAgICRpbnZlbnRvcnlTdW1tYXJ5ID0gJHByb2R1Y3QtPnJlbEludmVudG9yeVN1bW1hcnk7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAkaW52ZW50b3J5U3VtbWFyeSA9IG5ldyBJbnZlbnRvcnlTdW1tYXJ5KCk7CiAgICAgICAgICAgICAgICAgICAgJGludmVudG9yeVN1bW1hcnktPmNhdGVnb3J5X2lkID0gJGlucHV0c1snY2F0ZWdvcnlfaWQnXTsKICAgICAgICAgICAgICAgICAgICAkaW52ZW50b3J5U3VtbWFyeS0+cHJvZHVjdF9pZCA9ICRwcm9kdWN0LT5pZDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRpbnZlbnRvcnlTdW1tYXJ5LT5idWZmZXJfaW52ZW50b3J5ID0gJGJ1ZmZlckludmVudG9yeTsKICAgICAgICAgICAgICAgICRpbnZlbnRvcnlTdW1tYXJ5LT5zYXZlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFByb2R1Y3RBdHRyaWJ1dGU6OndoZXJlKCdwcm9kdWN0X2lkJywgJHByb2R1Y3QtPmlkKS0+ZGVsZXRlKCk7CiAgICAgICAgICAgIGlmKGlzc2V0KCRyZXF1ZXN0LT5wcm9kdWN0QXR0cmlidXRlc1swXSkpewogICAgICAgICAgICAgICAgZm9yZWFjaCgkcmVxdWVzdC0+cHJvZHVjdEF0dHJpYnV0ZXMgYXMgJGtleSA9PiAkYXR0cmlidXRlX2lkKXsKICAgICAgICAgICAgICAgICAgICAkc2VyaWFsX25vID0gQ2F0ZWdvcnlBdHRyaWJ1dGU6OndoZXJlKFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2NhdGVnb3J5X2lkJyA9PiAkcmVxdWVzdC0+Y2F0ZWdvcnlfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdhdHRyaWJ1dGVfaWQnID0+ICRhdHRyaWJ1dGVfaWQKICAgICAgICAgICAgICAgICAgICBdKS0+c3VtKCdzZXJpYWwnKTsKICAgICAgICAgICAgICAgICAgICBpZihpc3NldCgkcmVxdWVzdC0+YXR0cmlidXRlX29wdGlvbl9pZFskYXR0cmlidXRlX2lkXSkgJiYgJHJlcXVlc3QtPmF0dHJpYnV0ZV9vcHRpb25faWRbJGF0dHJpYnV0ZV9pZF0gIT0gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgIFByb2R1Y3RBdHRyaWJ1dGU6OmNyZWF0ZShbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncHJvZHVjdF9pZCcgPT4gJHByb2R1Y3QtPmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2F0dHJpYnV0ZV9vcHRpb25faWQnID0+ICRyZXF1ZXN0LT5hdHRyaWJ1dGVfb3B0aW9uX2lkWyRhdHRyaWJ1dGVfaWRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NlcmlhbF9ubycgPT4gJHNlcmlhbF9ubywKICAgICAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkcHJvZHVjdHMgPSBQcm9kdWN0Ojp3aXRoKFsKICAgICAgICAgICAgICAgICdhdHRyaWJ1dGVzLmF0dHJpYnV0ZU9wdGlvbi5hdHRyaWJ1dGUnCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmUoWwogICAgICAgICAgICAgICAgWydpZCcsICchPScsICRwcm9kdWN0LT5pZF0sCiAgICAgICAgICAgICAgICBbJ25hbWUnLCAkcHJvZHVjdC0+bmFtZV0sCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2F0dHJpYnV0ZXMnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRwcm9kdWN0KSB7CiAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlSW4oJ2F0dHJpYnV0ZV9vcHRpb25faWQnLCAkcHJvZHVjdC0+YXR0cmlidXRlcy0+cGx1Y2soJ2F0dHJpYnV0ZV9vcHRpb25faWQnKS0+dG9BcnJheSgpKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT5nZXQoKTsKICAgICAgICAgICAgJGNvdW50ID0gMDsKICAgICAgICAgICAgaWYoaXNzZXQoJHByb2R1Y3RzWzBdKSl7CiAgICAgICAgICAgICAgICBmb3JlYWNoKCRwcm9kdWN0cyBhcyAka2V5ID0+ICR0aGlzX3Byb2R1Y3QpewogICAgICAgICAgICAgICAgICAgIGlmKGdldFByb2R1Y3RBdHRyaWJ1dGVzRmFzdGVyKCRwcm9kdWN0KSA9PSBnZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkdGhpc19wcm9kdWN0KSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGhpc19wcm9kdWN0LT5uYW1lLicgJy5nZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkdGhpc19wcm9kdWN0KS4nIGFscmVhZHkgZXhpc3RzIScsCiAgICAgICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXBkYXRlU3VwcGxpZXJQcm9kdWN0cygxMik7CiAgICAgICAgICAgIERCOjpjb21taXQoKTsKCiAgICAgICAgICAgIHNlc3Npb24oKS0+Zmxhc2goJ2FsZXJ0LXR5cGUnLCAnc3VjY2VzcycpOwogICAgICAgICAgICBzZXNzaW9uKCktPmZsYXNoKCdtZXNzYWdlJywgJ1Byb2R1Y3QgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAndXJsJyA9PiB1cmwoJ3Btcy9wcm9kdWN0LW1hbmFnZW1lbnQvcHJvZHVjdCcpCiAgICAgICAgICAgIF0pOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICBEQjo6cm9sbGJhY2soKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gJHRoLT5nZXRNZXNzYWdlKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UgZnJvbSBzdG9yYWdlLgogICAgICoKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveShQcm9kdWN0ICRwcm9kdWN0KQogICAgewogICAgICAgIGlmKGZyZWV6ZVByb2R1Y3QoJHByb2R1Y3QpKXsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJQcm9kdWN0ICMiLiRwcm9kdWN0LT5uYW1lLiIgIi5nZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkcHJvZHVjdCkuIiBDYW5ub3QgQmUgRGVsZXRlZCEiCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJHByb2R1Y3QtPnN1cHBsaWVycygpLT5zeW5jKFtdKTsKICAgICAgICAgICAgUHJvZHVjdEF0dHJpYnV0ZTo6d2hlcmUoJ3Byb2R1Y3RfaWQnLCAkcHJvZHVjdC0+aWQpLT5kZWxldGUoKTsKICAgICAgICAgICAgJHByb2R1Y3QtPmRlbGV0ZSgpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZQogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICR0aC0+Z2V0TWVzc2FnZSgpCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gaW1wb3J0UHJvZHVjdFNhbXBsZSgpewogICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAnYXR0cmlidXRlcycgPT4gQXR0cmlidXRlOjpnZXQoWydpZCcsJ25hbWUnXSksCiAgICAgICAgICAgICdjYXRlZ29yeScgPT4gQ2F0ZWdvcnk6OmhhcygnY2F0ZWdvcnknKS0+aW5SYW5kb21PcmRlcigpLT5maXJzdChbJ2NvZGUnXSksCiAgICAgICAgICAgICdicmFuZCcgPT4gQnJhbmQ6OmluUmFuZG9tT3JkZXIoKS0+Zmlyc3QoWydjb2RlJ10pLAogICAgICAgICAgICAndW5pdCcgPT4gUHJvZHVjdFVuaXQ6OmluUmFuZG9tT3JkZXIoKS0+Zmlyc3QoWyd1bml0X25hbWUnXSksCiAgICAgICAgICAgICdzdXBwbGllcl9tb2JpbGUnID0+IFN1cHBsaWVyczo6d2hlcmUoJ3N0YXR1cycsICdBY3RpdmUnKS0+aW5SYW5kb21PcmRlcigpLT50YWtlKCczJyktPnBsdWNrKCdtb2JpbGVfbm8nKS0+aW1wbG9kZSgnLCcpCiAgICAgICAgXTsKCiAgICAgICAgcmV0dXJuIEV4Y2VsOjpkb3dubG9hZChuZXcgXEFwcFxFeHBvcnRzXFBNU1xQcm9kdWN0U2FtcGxlKCRkYXRhKSwgJ1Byb2R1Y3QgVXBsb2FkIFNhbXBsZS54bHN4Jyk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGltcG9ydFByb2R1Y3QoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkdGhpcy0+dmFsaWRhdGUoJHJlcXVlc3QsIFsKICAgICAgICAgICAgJ3Byb2R1Y3RfZmlsZScgID0+ICdtaW1lczp4bHMseGxzeCcKICAgICAgICBdKTsKCiAgICAgICAgLy8kcGF0aCA9ICRyZXF1ZXN0LT5maWxlKCdwcm9kdWN0X2ZpbGUnKS0+Z2V0UmVhbFBhdGgoKTsKCiAgICAgICAgdHJ5IHsKCiAgICAgICAgICAgIEV4Y2VsOjppbXBvcnQobmV3IFByb2R1Y3RJbXBvcnQsICRyZXF1ZXN0LT5wcm9kdWN0X2ZpbGUpOwoKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aFN1Y2Nlc3MoJ0V4Y2VsIERhdGEgSW1wb3J0ZWQgc3VjY2Vzc2Z1bGx5LicpOwoKICAgICAgICB9Y2F0Y2ggKFxNYWF0d2Vic2l0ZVxFeGNlbFxWYWxpZGF0b3JzXFZhbGlkYXRpb25FeGNlcHRpb24gJGUpIHsKICAgICAgICAgICAgJGZhaWx1cmVzID0gJGUtPmZhaWx1cmVzKCk7CiAgICAgICAgICAgICRlcnJvcj1bXTsKICAgICAgICAgICAgZm9yZWFjaCAoJGZhaWx1cmVzIGFzICRmYWlsdXJlKSB7CiAgICAgICAgICAgICAgICAkZmFpbHVyZS0+cm93KCk7IAogICAgICAgICAgICAgICAgJGZhaWx1cmUtPmF0dHJpYnV0ZSgpOyAKICAgICAgICAgICAgICAgICRlcnJvcltdPSRmYWlsdXJlLT5lcnJvcnMoKTsgCiAgICAgICAgICAgICAgICAkZmFpbHVyZS0+dmFsdWVzKCk7IAogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJGVycm9yWzBdWzBdKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHRvZ2dsZShSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAgJHByb2R1Y3QgPSBQcm9kdWN0Ojp3aXRoKFsnYXR0cmlidXRlcy5hdHRyaWJ1dGVPcHRpb24uYXR0cmlidXRlJ10pLT5maW5kT3JGYWlsKCRpZCk7CiAgICAgICAgJHByb2R1Y3QtPnN0YXR1cyA9ICgkcHJvZHVjdC0+c3RhdHVzID09ICdwZW5kaW5nJyA/ICdhcHByb3ZlZCcgOiAncGVuZGluZycpOwogICAgICAgICRwcm9kdWN0LT5zYXZlKCk7CgogICAgICAgIGlmKCRwcm9kdWN0KXsKICAgICAgICAgICAgaWYoJHByb2R1Y3QtPnN0YXR1cyA9PSAnYXBwcm92ZWQnKXsKICAgICAgICAgICAgICAgICRtZXNzYWdlPSAnPHNwYW4gY2xhc3M9Im5vdGlmaWNhdGlvbi1saW5rcyIgZGF0YS1zcmM9IicudXJsKCdwbXMvcHJvZHVjdC1tYW5hZ2VtZW50L3Byb2R1Y3QvJy4kcHJvZHVjdC0+aWQuJy9kZXRhaWxzJykuJyIgZGF0YS10aXRsZT0iUHJvZHVjdCBEZXRhaWxzIj5Qcm9kdWN0ICcuJHByb2R1Y3QtPm5hbWUuJyAnLmdldFByb2R1Y3RBdHRyaWJ1dGVzRmFzdGVyKCRwcm9kdWN0KS4nIGhhcyBiZWVuIGFwcHJvdmVkLjwvc3Bhbj4nOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBDcmVhdGVPclVwZGF0ZU5vdGlmaWNhdGlvbigkbWVzc2FnZSwndW5yZWFkJywnJyxbJHByb2R1Y3QtPmNyZWF0ZWRfYnldLCdzZW5kLXRvLWVtcGxveWVlJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJQcm9kdWN0IGhhcyBiZWVuICIudWN3b3JkcygkcHJvZHVjdC0+c3RhdHVzKSwKICAgICAgICAgICAgICAgICJidXR0b24iID0+ICc8YSBjbGFzcz0iYnRuIGJ0bi14cyBidG4tJy4oJHByb2R1Y3QtPnN0YXR1cyA9PSAncGVuZGluZycgPyAnd2FybmluZycgOiAnc3VjY2VzcycpLiciICcuKGF1dGgoKS0+dXNlcigpLT5oYXNSb2xlKCdQdXJjaGFzZS1EZXBhcnRtZW50JykgPyAnb25jbGljaz0idG9nZ2xlUHJvZHVjdCgkKHRoaXMpKSInIDogJycpLicgZGF0YS1wcm9kdWN0LWlkPSInLiRwcm9kdWN0LT5pZC4nIiBkYXRhLXN0YXR1cz0iJy4kcHJvZHVjdC0+c3RhdHVzLiciIHN0eWxlPSJjdXJzb3I6IHBvaW50ZXIiPicudWN3b3JkcygkcHJvZHVjdC0+c3RhdHVzKS4nPC9hPicsIAogICAgICAgICAgICBdKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAnbWVzc2FnZScgPT4gIlNvbWV0aGluZyB3ZW50IHdyb25nISIKICAgICAgICBdKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZGV0YWlscyAoJHByb2R1Y3RfaWQpCiAgICB7CiAgICAgICAgJHByb2R1Y3QgPSBQcm9kdWN0OjpmaW5kT3JGYWlsKCRwcm9kdWN0X2lkKTsKICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMucHJvZHVjdHMuZGV0YWlscycsIGNvbXBhY3QoJ3Byb2R1Y3QnKSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGdldFN1YkFzc2V0cygkaWQpCiAgICB7CiAgICAgICAgJHByb2R1Y3RzID0gUHJvZHVjdDo6d2l0aChbCiAgICAgICAgICAgICdhdHRyaWJ1dGVzLmF0dHJpYnV0ZU9wdGlvbi5hdHRyaWJ1dGUnCiAgICAgICAgXSkKICAgICAgICAtPndoZXJlKFsKICAgICAgICAgICAgJ2NhdGVnb3J5X2lkJyA9PiAkaWQsCiAgICAgICAgICAgICdwYXJlbnRfaWQnID0+IDAKICAgICAgICBdKS0+Z2V0KCk7CiAgICAgICAgJHJlc3BvbnNlID0gJzxvcHRpb24gdmFsdWU9IjAiIGRhdGEtY29kZT0iIj5OL0E8L29wdGlvbj4nOwogICAgICAgIGlmKGlzc2V0KCRwcm9kdWN0c1swXSkpewogICAgICAgICAgICBmb3JlYWNoICgkcHJvZHVjdHMgYXMgJGtleSA9PiAkcHJvZHVjdCkgewogICAgICAgICAgICAgICAgJHN1YkFzc2V0cyA9ICgkcHJvZHVjdC0+c3ViQXNzZXRzLT5jb3VudCgpKzEpOwogICAgICAgICAgICAgICAgJGNvZGUgPSAoJHByb2R1Y3QtPnNrdS4nLScuKCRzdWJBc3NldHMgPCA5ID8gJzAnIDogJycpLiRzdWJBc3NldHMpOwogICAgICAgICAgICAgICAgJHJlc3BvbnNlIC49ICc8b3B0aW9uIHZhbHVlPSInLiRwcm9kdWN0LT5pZC4nIiBkYXRhLWNvZGU9IicuJGNvZGUuJyIgJy4ocmVxdWVzdCgpLT5nZXQoJ3NlbGVjdGVkJykgPT0gJHByb2R1Y3QtPmlkID8gJ3NlbGVjdGVkJyA6ICcnKS4nPicuJHByb2R1Y3QtPm5hbWUuJyAnLmdldFByb2R1Y3RBdHRyaWJ1dGVzRmFzdGVyKCRwcm9kdWN0KS4nPC9vcHRpb24+JzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICRyZXNwb25zZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0U3RhbmRhcmRDb3N0cygkaWQpewogICAgICAgICRwcm9kdWN0ID0gUHJvZHVjdDo6ZmluZE9yRmFpbCgkaWQpOwogICAgICAgIHJldHVybiB2aWV3KCdwbXMuYmFja2VuZC5wYWdlcy5wcm9kdWN0cy5zdGFuZGFyZC1jb3N0cycsIFsKICAgICAgICAgICAgJ3RpdGxlJyA9PiAiU3RhbmRhcmQgQ29zdHMgZm9yICIuJHByb2R1Y3QtPm5hbWUuJyAnLmdldFByb2R1Y3RBdHRyaWJ1dGVzRmFzdGVyKCRwcm9kdWN0KSwKICAgICAgICAgICAgJ3Byb2R1Y3QnID0+ICRwcm9kdWN0LAogICAgICAgICAgICAnc3RhbmRhcmRDb3N0cycgPT4gU3RhbmRhcmRDb3N0OjphbGwoKQogICAgICAgIF0pOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGVTdGFuZGFyZENvc3RzKFJlcXVlc3QgJHJlcXVlc3QsICRpZCkKICAgIHsKICAgICAgICAkcmVxdWVzdC0+dmFsaWRhdGUoWwogICAgICAgICAgICAnYW1vdW50cycgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2Ftb3VudHMuKicgPT4gJ3JlcXVpcmVkJywKICAgICAgICBdKTsKCiAgICAgICAgJHByb2R1Y3QgPSBQcm9kdWN0OjpmaW5kT3JGYWlsKCRpZCk7CiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7ICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgZm9yZWFjaCgkcmVxdWVzdC0+YW1vdW50cyBhcyAkc3RhbmRhcmRfY29zdF9pZCA9PiAkYW1vdW50KXsKICAgICAgICAgICAgICAgIFByb2R1Y3RTdGFuZGFyZENvc3Q6OnVwZGF0ZU9yQ3JlYXRlKFsKICAgICAgICAgICAgICAgICAgICAncHJvZHVjdF9pZCcgPT4gJHByb2R1Y3QtPmlkLAogICAgICAgICAgICAgICAgICAgICdzdGFuZGFyZF9jb3N0X2lkJyA9PiAkc3RhbmRhcmRfY29zdF9pZCwKICAgICAgICAgICAgICAgIF0sIFsKICAgICAgICAgICAgICAgICAgICAnYW1vdW50JyA9PiAkYW1vdW50CiAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICAkbm90aWZpY2F0aW9uID0gWwogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJTdGFuZGFyZCBjb3N0cyBoYXMgYmVlbiB1cGRhdGVkIiwKICAgICAgICAgICAgICAgICdhbGVydC10eXBlJyA9PiAnc3VjY2VzcycKICAgICAgICAgICAgXTsKICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0KCdwbXMvcHJvZHVjdC1tYW5hZ2VtZW50L3Byb2R1Y3QvJy4kcHJvZHVjdC0+aWQuJy9zdGFuZGFyZC1jb3N0cycpLT53aXRoKCRub3RpZmljYXRpb24pOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICBEQjo6cm9sbGJhY2soKTsKICAgICAgICAgICAgJG5vdGlmaWNhdGlvbiA9IFsKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKSwKICAgICAgICAgICAgICAgICdhbGVydC10eXBlJyA9PiAnZXJyb3InCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHJldHVybiByZWRpcmVjdCgncG1zL3Byb2R1Y3QtbWFuYWdlbWVudC9wcm9kdWN0LycuJHByb2R1Y3QtPmlkLicvc3RhbmRhcmQtY29zdHMnKS0+d2l0aCgkbm90aWZpY2F0aW9uKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVuaXRDb252ZXJzaW9ucygkaWQpCiAgICB7CiAgICAgICAgJHByb2R1Y3QgPSBQcm9kdWN0Ojp3aXRoKFsKICAgICAgICAgICAgJ3Byb2R1Y3RVbml0Lm1hdHJpeGVzJywKICAgICAgICAgICAgJ3Byb2R1Y3RVbml0Q29udmVyc2lvbnMnCiAgICAgICAgXSktPmZpbmRPckZhaWwoJGlkKTsKICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMucHJvZHVjdHMudW5pdC1jb252ZXJzaW9ucycsIFsKICAgICAgICAgICAgJ3Byb2R1Y3QnID0+ICRwcm9kdWN0LAogICAgICAgICAgICAndW5pdHMnID0+IFByb2R1Y3RVbml0Ojp3aGVyZSgnaWQnLCAnIT0nLCAkcHJvZHVjdC0+cHJvZHVjdF91bml0X2lkKS0+Z2V0KCksCiAgICAgICAgXSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZVVuaXRDb252ZXJzaW9ucyhSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgICRwcm9kdWN0ID0gUHJvZHVjdDo6d2l0aChbCiAgICAgICAgICAgICAgICAncHJvZHVjdFVuaXQubWF0cml4ZXMnLAogICAgICAgICAgICAgICAgJ3Byb2R1Y3RVbml0Q29udmVyc2lvbnMnCiAgICAgICAgICAgIF0pLT5maW5kT3JGYWlsKCRpZCk7CiAgICAgICAgICAgICR1bml0cyA9IFByb2R1Y3RVbml0Ojp3aGVyZSgnaWQnLCAnIT0nLCAkcHJvZHVjdC0+cHJvZHVjdF91bml0X2lkKS0+Z2V0KCk7CiAgICAgICAgICAgIGlmKGlzc2V0KCR1bml0c1swXSkpewogICAgICAgICAgICAgICAgZm9yZWFjaCgkdW5pdHMgYXMgJHVuaXQpewogICAgICAgICAgICAgICAgICAgIFByb2R1Y3RVbml0Q29udmVyc2lvbjo6dXBkYXRlT3JDcmVhdGUoWwogICAgICAgICAgICAgICAgICAgICAgICAncHJvZHVjdF9pZCcgPT4gJGlkLAogICAgICAgICAgICAgICAgICAgICAgICAncHJvZHVjdF91bml0X2lkJyA9PiAkcHJvZHVjdC0+cHJvZHVjdF91bml0X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAnY29udmVyc2lvbl91bml0X2lkJyA9PiAkdW5pdC0+aWQKICAgICAgICAgICAgICAgICAgICBdLCBbCiAgICAgICAgICAgICAgICAgICAgICAgICdjb252ZXJzaW9uX3JhdGUnID0+IGlzc2V0KCRyZXF1ZXN0LT51bml0c1skdW5pdC0+aWRdKSAmJiAkcmVxdWVzdC0+dW5pdHNbJHVuaXQtPmlkXSA+PSAwID8gJHJlcXVlc3QtPnVuaXRzWyR1bml0LT5pZF0gOiAwLAogICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJVbml0IENvbnZlcnNpb25zIGhhcyBiZWVuIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LiIKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIERCOjpyb2xsYmFjaygpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gJHRoLT5nZXRNZXNzYWdlKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzdXBwbGllcnMoJGlkKQogICAgewogICAgICAgICRwcm9kdWN0ID0gUHJvZHVjdDo6d2l0aChbCiAgICAgICAgICAgICdzdXBwbGllcnMnLAogICAgICAgIF0pLT5maW5kT3JGYWlsKCRpZCk7CgogICAgICAgIHJldHVybiB2aWV3KCdwbXMuYmFja2VuZC5wYWdlcy5wcm9kdWN0cy51cGRhdGUtc3VwcGxpZXJzJywgWwogICAgICAgICAgICAncHJvZHVjdCcgPT4gJHByb2R1Y3QsCiAgICAgICAgICAgICdzdXBwbGllcnMnID0+IFN1cHBsaWVyczo6d2hlcmUoJ3N0YXR1cycsICdBY3RpdmUnKS0+Z2V0KFsnaWQnLCAnbmFtZSddKSwKICAgICAgICAgICAgJ2V4aXN0ZWRTdXBwbGllcnMnID0+ICRwcm9kdWN0LT5zdXBwbGllcnMtPnBsdWNrKCdwaXZvdC5zdXBwbGllcl9pZCcpLT50b0FycmF5KCksCiAgICAgICAgXSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZVN1cHBsaWVycyhSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgICRwcm9kdWN0ID0gUHJvZHVjdDo6d2l0aChbCiAgICAgICAgICAgICAgICAncHJvZHVjdFVuaXQubWF0cml4ZXMnLAogICAgICAgICAgICAgICAgJ3Byb2R1Y3RVbml0Q29udmVyc2lvbnMnCiAgICAgICAgICAgIF0pLT5maW5kT3JGYWlsKCRpZCk7CiAgICAgICAgICAgICRwcm9kdWN0LT5zdXBwbGllcnMoKS0+c3luYyhpc3NldCgkcmVxdWVzdC0+c3VwcGxpZXJbMF0pID8gJHJlcXVlc3QtPnN1cHBsaWVyIDogW10pOwoKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAiUHJvZHVjdCBTdXBwbGllcnMgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkuIgogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9Cn0K