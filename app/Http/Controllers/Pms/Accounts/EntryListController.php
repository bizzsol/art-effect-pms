<?php
bolt_decrypt( __FILE__ , 'dJK3pd'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zXEFjY291bnRzOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFN1cHBsaWVyUGF5bWVudDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFN1cHBsaWVyTGVkZ2VyczsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFN1cHBsaWVyczsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFB1cmNoYXNlXFB1cmNoYXNlT3JkZXI7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xQdXJjaGFzZVxQdXJjaGFzZU9yZGVyRW50cnk7CnVzZSBEQjsKdXNlIEF1dGg7CnVzZSBBcHA7CnVzZSBEYXRhVGFibGVzOwoKY2xhc3MgRW50cnlMaXN0Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKeyAgIAogICAgLyoqCiAgICAgKiBTZXQgZ2xvYmFsIGRhdGEgdGFibGUgaGVhZGVycy4KICAgICAqCiAgICAgKiBAcmV0dXJuIGhlYWRlckNvbHVtbnMKICAgICAqLwoKICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgIHsKICAgICAgICAkcm93cyA9ICBhcnJheSgKICAgICAgICAgICAgWydTTCcsICdTTCddLAogICAgICAgICAgICBbJ3BvX2RhdGUnLCAncG9fZGF0ZSddLAogICAgICAgICAgICBbJ3JlZmVyZW5jZV9ubycsICdyZWZlcmVuY2Vfbm8nXSwKICAgICAgICAgICAgWydzdXBwbGllcnMnLCAnc3VwcGxpZXJzJywgJ3RleHQtbGVmdCddLAogICAgICAgICAgICBbJ3F1b3RhdGlvbl9yZWZfbm8nLCAncXVvdGF0aW9uX3JlZl9ubycsICd0ZXh0LWxlZnQnXSwgCiAgICAgICAgICAgIFsnY3VycmVuY3knLCAnY3VycmVuY3knLCAndGV4dC1yaWdodCddLAogICAgICAgICAgICBbJ3RvdGFsX3ByaWNlJywgJ3RvdGFsX3ByaWNlJywgJ3RleHQtcmlnaHQnXSwgCiAgICAgICAgICAgIFsndmF0JywgJ3ZhdCcsICd0ZXh0LXJpZ2h0J10sCiAgICAgICAgICAgIFsnZ3Jvc3NfcHJpY2UnLCAnZ3Jvc3NfcHJpY2UnLCAndGV4dC1yaWdodCddLAogICAgICAgICAgICBbJ2FjdGlvbnMnLCAnYWN0aW9ucycsICd0ZXh0LWNlbnRlciddLAogICAgICAgICk7CiAgICAgICAgcmV0dXJuICRyb3dzOwogICAgfQogICAgLyoqCiAgICAgKiBEaXNwbGF5IGEgbGlzdGluZyBvZiB0aGUgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgdHJ5IHsKCiAgICAgICAgICAgICRwdXJjaGFzZU9yZGVyPSBQdXJjaGFzZU9yZGVyOjp3aXRoKFsncmVsUXVvdGF0aW9uJywncmVsUXVvdGF0aW9uLnJlbFN1cHBsaWVycycsJ3JlbFF1b3RhdGlvbi5leGNoYW5nZVJhdGUuY3VycmVuY3knXSkKICAgICAgICAgICAgLT53aGVyZUhhcygncHVyY2hhc2VPcmRlckVudHJpZXMnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZVJhdygncHVyY2hhc2Vfb3JkZXJzLmlkPXB1cmNoYXNlX29yZGVyX2VudHJpZXMucHVyY2hhc2Vfb3JkZXJfaWQnKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVuKCFkYXRhdGFibGVPcmRlcmluZygpLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaWQnLCAnZGVzYycpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERhdGF0YWJsZXM6Om9mKCRwdXJjaGFzZU9yZGVyKQogICAgICAgICAgICAgICAgLT5hZGRJbmRleENvbHVtbigpCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3BvX2RhdGUnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZSgnZC1NLVknLCBzdHJ0b3RpbWUoJHZhbHVlcy0+cG9fZGF0ZSkpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdyZWZlcmVuY2Vfbm8nLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxhIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKSIgb25jbGljaz0icHVyY2hhc2VPcmRlckRldGFpbHMoJCh0aGlzKSkiIGNsYXNzPSJidG4gYnRuLWxpbmsgc2hvd1BPRGV0YWlscyIgZGF0YS1zcmM9Iicucm91dGUoJ3Btcy5wdXJjaGFzZS5vcmRlci1saXN0LnNob3cnLCR2YWx1ZXMtPmlkKS4nIj4nLiR2YWx1ZXMtPnJlZmVyZW5jZV9uby4nPC9hPic7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3JlZmVyZW5jZV9ubycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3JlZmVyZW5jZV9ubycsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3N1cHBsaWVycycsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkdmFsdWVzLT5yZWxRdW90YXRpb24pID8gKGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVsU3VwcGxpZXJzLT5uYW1lKSA/ICR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVsU3VwcGxpZXJzLT5uYW1lLicgKCcuJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPmNvZGUuJyknIDogJycpIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3N1cHBsaWVycycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uLnJlbFN1cHBsaWVycycsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5LiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdxdW90YXRpb25fcmVmX25vJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVmZXJlbmNlX25vKT8kdmFsdWVzLT5yZWxRdW90YXRpb24tPnJlZmVyZW5jZV9ubzonJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncXVvdGF0aW9uX3JlZl9ubycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgncmVmZXJlbmNlX25vJywgJ0xJS0UnLCAnJScuJGtleS4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjdXJyZW5jeScsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkdmFsdWVzLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPmNvZGUpPyR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+ZXhjaGFuZ2VSYXRlLT5jdXJyZW5jeS0+Y29kZTonJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3JlbFF1b3RhdGlvbi5leGNoYW5nZVJhdGUuY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScuJGtleS4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3RvdGFsX3ByaWNlJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5c3RlbURvdWJsZVZhbHVlKCR2YWx1ZXMtPnRvdGFsX3ByaWNlKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3ZhdCcsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzeXN0ZW1Eb3VibGVWYWx1ZSgkdmFsdWVzLT52YXQsIDIpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbignZ3Jvc3NfcHJpY2UnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3lzdGVtRG91YmxlVmFsdWUoJHZhbHVlcy0+Z3Jvc3NfcHJpY2UsIDIpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhY3Rpb25zJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iJy5yb3V0ZSgncG1zLmFjY291bnRzLnBvLndpc2UuZW50cnkuc2hvdycsJHZhbHVlcy0+aWQpLicvcHJpbnQiICB0aXRsZT0iUHJpbnQgQWxsIFRyYW5zYWN0aW9ucyIgY2xhc3M9ImJ0biBtYi0xIGJ0bi14cyBidG4tc3VjY2VzcyI+PGkgY2xhc3M9ImxhcyBsYS1wcmludCI+PC9pPlByaW50PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgdGFyZ2V0PSJfX2JsYW5rIiBocmVmPSInLnJvdXRlKCdwbXMuYWNjb3VudHMucG8ud2lzZS5lbnRyeS5zaG93JywkdmFsdWVzLT5pZCkuJyIgIHRpdGxlPSJFbnRyeSBMaXN0IiBjbGFzcz0iYnRuIG1iLTEgYnRuLXhzIGJ0bi1pbmZvIj48aSBjbGFzcz0ibGFyIGxhLXBsdXMtc3F1YXJlIj48L2k+RW50cmllczwvYT4nOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+cmF3Q29sdW1ucyhbJ2RhdGUnLCAncmVmZXJlbmNlX25vJywgJ3RvdGFsX3ByaWNlJywgJ3ZhdCcsICdncm9zc19wcmljZScsICdhY3Rpb25zJ10pCiAgICAgICAgICAgICAgICAtPm1ha2UodHJ1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnUHVyY2hhc2UgT3JkZXIgV2lzZSBFbnRyeSBMaXN0JywKICAgICAgICAgICAgICAgICdoZWFkZXJDb2x1bW5zJyA9PiAkdGhpcy0+aGVhZGVyQ29sdW1ucygpLAogICAgICAgICAgICBdOwoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLmFjY291bnRzLnBvLXdpc2UtZW50cnktbGlzdCcsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgIC8qKgogICAgICogRGlzcGxheSB0aGUgc3BlY2lmaWVkIHJlc291cmNlLgogICAgICoKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICAgcHVibGljIGZ1bmN0aW9uIHBvV2lzZUVudHJ5TGlzdCgkaWQpCiAgICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRlbnRyeUxpc3QgPSBQdXJjaGFzZU9yZGVyRW50cnk6OndpdGgoWwogICAgICAgICAgICAgICAgJ2VudHJ5Lml0ZW1zLmNoYXJ0T2ZBY2NvdW50JywKICAgICAgICAgICAgICAgICdlbnRyeS5lbnRyeVR5cGUnLAogICAgICAgICAgICAgICAgJ2VudHJ5LmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmUoJ3B1cmNoYXNlX29yZGVyX2lkJywkaWQpCiAgICAgICAgICAgIC0+b3JkZXJCeSgnaWQnLCAnZGVzYycpCiAgICAgICAgICAgIC0+cGFnaW5hdGUoMTAwKTsKCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnRW50cnkgTGlzdCcsCiAgICAgICAgICAgICAgICAnZW50cnlMaXN0JyA9PiAkZW50cnlMaXN0LAogICAgICAgICAgICBdOwoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLmFjY291bnRzLmVudHJ5LWxpc3QnLCAkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBwb1dpc2VFbnRyeUxpc3RQcmludCgkaWQpCiAgICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRwdXJjaGFzZU9yZGVyID0gUHVyY2hhc2VPcmRlcjo6d2l0aChbCiAgICAgICAgICAgICAgICAncHVyY2hhc2VPcmRlckVudHJpZXMuZW50cnkuaXRlbXMuY2hhcnRPZkFjY291bnQnLAogICAgICAgICAgICAgICAgJ3B1cmNoYXNlT3JkZXJFbnRyaWVzLmVudHJ5Lml0ZW1zLmNvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnknLAogICAgICAgICAgICAgICAgJ3B1cmNoYXNlT3JkZXJFbnRyaWVzLmVudHJ5LmVudHJ5VHlwZScsCiAgICAgICAgICAgICAgICAncHVyY2hhc2VPcmRlckVudHJpZXMuZW50cnkuZXhjaGFuZ2VSYXRlLmN1cnJlbmN5JywKICAgICAgICAgICAgXSktPmZpbmRPckZhaWwoJGlkKTsKICAgICAgICAgICAgJHRpdGxlID0gJ1B1cmNoYXNlIE9yZGVyIFRyYW5zYWN0aW9ucyAjJy4kcHVyY2hhc2VPcmRlci0+cmVmZXJlbmNlX25vOwogICAgICAgICAgICByZXR1cm4gdmlld01QREYoJ3Btcy5iYWNrZW5kLnBhZ2VzLmFjY291bnRzLmVudHJ5LWxpc3QtcHJpbnQnLCBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICR0aXRsZSwKICAgICAgICAgICAgICAgICdzeXN0ZW1DdXJyZW5jeScgPT4gc3lzdGVtQ3VycmVuY3koKSwKICAgICAgICAgICAgICAgICdwdXJjaGFzZU9yZGVyJyA9PiAkcHVyY2hhc2VPcmRlciwKICAgICAgICAgICAgXSwgJHRpdGxlLCAkdGl0bGUpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNob3cgdGhlIGZvcm0gZm9yIHN1cHBsaWVyV2lzZUVudHJ5TGlzdCBhIG5ldyByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHN1cHBsaWVyV2lzZUVudHJ5TGlzdCgpCiAgICB7CiAgICAgICAgdHJ5IHsKCiAgICAgICAgICAgICRmcm9tX2RhdGUgPSByZXF1ZXN0KCktPmhhcygnZnJvbV9kYXRlJykgJiYgIWVtcHR5KHJlcXVlc3QoKS0+Z2V0KCdmcm9tX2RhdGUnKSkgPyBkYXRlKCJZLW0tZCIsIHN0cnRvdGltZShyZXF1ZXN0KCktPmdldCgnZnJvbV9kYXRlJykpKSA6IGRhdGUoIlktbS1kIiwgc3RydG90aW1lKGRhdGUoJ1ktbS0wMScpKSk7CiAgICAgICAgICAgICR0b19kYXRlID0gcmVxdWVzdCgpLT5oYXMoJ3RvX2RhdGUnKSAmJiAhZW1wdHkocmVxdWVzdCgpLT5nZXQoJ3RvX2RhdGUnKSkgPyBkYXRlKCJZLW0tZCIsIHN0cnRvdGltZShyZXF1ZXN0KCktPmdldCgndG9fZGF0ZScpKSkgOiBkYXRlKCJZLW0tZCIsIHN0cnRvdGltZShkYXRlKCdZLW0tdCcpKSk7CiAgICAgICAgICAgICRzdXBwbGllcl9pZCA9IHJlcXVlc3QoKS0+aGFzKCdzdXBwbGllcl9pZCcpID8gcmVxdWVzdCgpLT5nZXQoJ3N1cHBsaWVyX2lkJykgOiBudWxsOwogICAgICAgICAgICAkc2VsZWN0ZWRfc3VwcGxpZXIgPSBTdXBwbGllcnM6OmZpbmQoJHN1cHBsaWVyX2lkKTsKCiAgICAgICAgICAgICRzdXBwbGllcnMgPSBTdXBwbGllcnM6OndoZXJlKCdzdGF0dXMnLCAnQWN0aXZlJykKICAgICAgICAgICAgLT5oYXMoJ3JlbFF1b3RhdGlvbnMucmVsUHVyY2hhc2VPcmRlci5wdXJjaGFzZU9yZGVyRW50cmllcycpCiAgICAgICAgICAgIC0+Z2V0KFsnaWQnLCAnbmFtZSddKTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAkcHVyY2hhc2VPcmRlcj0gUHVyY2hhc2VPcmRlcjo6d2l0aChbJ3JlbFF1b3RhdGlvbicsJ3JlbFF1b3RhdGlvbi5yZWxTdXBwbGllcnMnLCdyZWxRdW90YXRpb24uZXhjaGFuZ2VSYXRlLmN1cnJlbmN5J10pCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ3B1cmNoYXNlT3JkZXJFbnRyaWVzJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmVSYXcoJ3B1cmNoYXNlX29yZGVycy5pZD1wdXJjaGFzZV9vcmRlcl9lbnRyaWVzLnB1cmNoYXNlX29yZGVyX2lkJyk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+d2hlbihpc3NldCgkc3VwcGxpZXJfaWQpLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkc3VwcGxpZXJfaWQpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3JlbFF1b3RhdGlvbi5yZWxTdXBwbGllcnMnLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkc3VwcGxpZXJfaWQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdzdXBwbGllcl9pZCcsICRzdXBwbGllcl9pZCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVyZUJldHdlZW4oJ3BvX2RhdGUnLCBbJGZyb21fZGF0ZSwgJHRvX2RhdGVdKQogICAgICAgICAgICAtPndoZW4oIWRhdGF0YWJsZU9yZGVyaW5nKCksIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlcmJ5KCdpZCcsICdkZXNjJyk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHJlcXVlc3QoKS0+YWpheCgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YXRhYmxlczo6b2YoJHB1cmNoYXNlT3JkZXIpCiAgICAgICAgICAgICAgICAtPmFkZEluZGV4Q29sdW1uKCkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbigncG9fZGF0ZScsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRlKCdkLU0tWScsIHN0cnRvdGltZSgkdmFsdWVzLT5wb19kYXRlKSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3JlZmVyZW5jZV9ubycsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiBvbmNsaWNrPSJwdXJjaGFzZU9yZGVyRGV0YWlscygkKHRoaXMpKSIgY2xhc3M9ImJ0biBidG4tbGluayBzaG93UE9EZXRhaWxzIiBkYXRhLXNyYz0iJy5yb3V0ZSgncG1zLnB1cmNoYXNlLm9yZGVyLWxpc3Quc2hvdycsJHZhbHVlcy0+aWQpLiciPicuJHZhbHVlcy0+cmVmZXJlbmNlX25vLic8L2E+JzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncmVmZXJlbmNlX25vJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgncmVmZXJlbmNlX25vJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignc3VwcGxpZXJzJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbikgPyAoaXNzZXQoJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPm5hbWUpID8gJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPm5hbWUuJyAoJy4kdmFsdWVzLT5yZWxRdW90YXRpb24tPnJlbFN1cHBsaWVycy0+Y29kZS4nKScgOiAnJykgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignc3VwcGxpZXJzJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdyZWxRdW90YXRpb24ucmVsU3VwcGxpZXJzJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXkuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3F1b3RhdGlvbl9yZWZfbm8nLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWZlcmVuY2Vfbm8pPyR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVmZXJlbmNlX25vOicnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdxdW90YXRpb25fcmVmX25vJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdyZWxRdW90YXRpb24nLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdyZWZlcmVuY2Vfbm8nLCAnTElLRScsICclJy4ka2V5LiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2N1cnJlbmN5JywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+ZXhjaGFuZ2VSYXRlLT5jdXJyZW5jeS0+Y29kZSk/JHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5jb2RlOicnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdjdXJyZW5jeScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uLmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2NvZGUnLCAnTElLRScsICclJy4ka2V5LiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbigndG90YWxfcHJpY2UnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3lzdGVtRG91YmxlVmFsdWUoJHZhbHVlcy0+dG90YWxfcHJpY2UpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbigndmF0JywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5c3RlbURvdWJsZVZhbHVlKCR2YWx1ZXMtPnZhdCwgMik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5lZGl0Q29sdW1uKCdncm9zc19wcmljZScsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzeXN0ZW1Eb3VibGVWYWx1ZSgkdmFsdWVzLT5ncm9zc19wcmljZSwgMik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2FjdGlvbnMnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSInLnJvdXRlKCdwbXMuYWNjb3VudHMucG8ud2lzZS5lbnRyeS5zaG93JywkdmFsdWVzLT5pZCkuJy9wcmludCIgIHRpdGxlPSJQcmludCBBbGwgVHJhbnNhY3Rpb25zIiBjbGFzcz0iYnRuIG1iLTEgYnRuLXhzIGJ0bi1zdWNjZXNzIj48aSBjbGFzcz0ibGFzIGxhLXByaW50Ij48L2k+UHJpbnQ8L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSB0YXJnZXQ9Il9fYmxhbmsiIGhyZWY9Iicucm91dGUoJ3Btcy5hY2NvdW50cy5wby53aXNlLmVudHJ5LnNob3cnLCR2YWx1ZXMtPmlkKS4nIiAgdGl0bGU9IkVudHJ5IExpc3QiIGNsYXNzPSJidG4gbWItMSBidG4teHMgYnRuLWluZm8iPjxpIGNsYXNzPSJsYXIgbGEtcGx1cy1zcXVhcmUiPjwvaT5FbnRyaWVzPC9hPic7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5yYXdDb2x1bW5zKFsnZGF0ZScsICdyZWZlcmVuY2Vfbm8nLCAndG90YWxfcHJpY2UnLCAndmF0JywgJ2dyb3NzX3ByaWNlJywgJ2FjdGlvbnMnXSkKICAgICAgICAgICAgICAgIC0+bWFrZSh0cnVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICdTdXBwbGllciBXaXNlIEVudHJ5IExpc3QnLAogICAgICAgICAgICAgICAgJ2Zyb21fZGF0ZScgPT4gJGZyb21fZGF0ZSwKICAgICAgICAgICAgICAgICd0b19kYXRlJyA9PiAkdG9fZGF0ZSwKICAgICAgICAgICAgICAgICdzdXBwbGllcl9pZCcgPT4gJHN1cHBsaWVyX2lkLAogICAgICAgICAgICAgICAgJ2Nob29zZVN1cHBsaWVycycgPT4gJHN1cHBsaWVycywKICAgICAgICAgICAgICAgICdzZWxlY3RlZF9zdXBwbGllcicgPT4gJHNlbGVjdGVkX3N1cHBsaWVyLAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCksCiAgICAgICAgICAgIF07CgogICAgICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuYWNjb3VudHMuc3VwcGxpZXItd2lzZS1lbnRyeS1saXN0JywgJGRhdGEpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KfQo=