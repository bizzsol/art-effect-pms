<?php
bolt_decrypt( __FILE__ , 'Rd1ikE'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zXEFjY291bnRzOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFN1cHBsaWVyUGF5bWVudDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFN1cHBsaWVyTGVkZ2VyczsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFN1cHBsaWVyczsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFB1cmNoYXNlXFB1cmNoYXNlT3JkZXI7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xQdXJjaGFzZVxQdXJjaGFzZU9yZGVyQXR0YWNobWVudDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXEdyblxHb29kc1JlY2VpdmVkSXRlbTsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFF1b3RhdGlvbnM7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDb3N0Q2VudHJlOwp1c2UgREI7CnVzZSBBdXRoOwp1c2UgQXBwLCBEYXRhVGFibGVzOwoKCmNsYXNzIENhc2hBcHByb3ZhbENvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgIHsKICAgICAgICByZXR1cm4gYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnXSwgCiAgICAgICAgICAgIFsncG9fZGF0ZScsICdwb19kYXRlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsncmVmZXJlbmNlX25vJywgJ3JlZmVyZW5jZV9ubycsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3N1cHBsaWVyJywgJ3N1cHBsaWVyJywgJ3RleHQtbGVmdCddLCAKICAgICAgICAgICAgWydxdW90YXRpb25fcmVmX25vJywgJ3F1b3RhdGlvbl9yZWZfbm8nLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWyd0b3RhbF9wcmljZScsICd0b3RhbF9wcmljZScsICd0ZXh0LWxlZnQnXSwgCiAgICAgICAgICAgIFsndmF0JywgJ3ZhdCcsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2dyb3NzX3ByaWNlJywgJ2dyb3NzX3ByaWNlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnc3RhdHVzJywgJ2Nhc2hfc3RhdHVzJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYWN0aW9ucycsICdhY3Rpb25zJywgJ3RleHQtY2VudGVyIGFjdGlvbiddCiAgICAgICAgKTsKICAgIH0KICAgIC8qKgogICAgICogRGlzcGxheSBhIGxpc3Rpbmcgb2YgdGhlIHJlc291cmNlLgogICAgICoKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICR0aXRsZSA9ICJQdXJjaGFzZSBPcmRlciBDYXNoIEFwcHJvdmFsIjsKICAgICAgICAgICAgJGNhc2hfc3RhdHVzID0gcmVxdWVzdCgpLT5oYXMoJ2Nhc2hfc3RhdHVzJykgPyByZXF1ZXN0KCktPmdldCgnY2FzaF9zdGF0dXMnKSA6ICdwZW5kaW5nJzsKICAgICAgICAgICAgJGlzX3NlbmQgPSAoJGNhc2hfc3RhdHVzPT0ncGVuZGluZycgfHwgJGNhc2hfc3RhdHVzPT0naGFsdCcpPydubyc6bnVsbDsKCiAgICAgICAgICAgICRwdXJjaGFzZU9yZGVyID0gUHVyY2hhc2VPcmRlcjo6d2l0aChbCiAgICAgICAgICAgICAgICAncmVsUXVvdGF0aW9uLnJlbFN1cHBsaWVycycsCiAgICAgICAgICAgICAgICAncmVsUXVvdGF0aW9uLmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScKICAgICAgICAgICAgXSkKICAgICAgICAgICAgLT53aGVuKCFhdXRoKCktPnVzZXIoKS0+aGFzQW55Um9sZShbJ1B1cmNoYXNlLURlcGFydG1lbnQnLCAnQXVkaXQnLCAnQmlsbGluZycsICdNYW5hZ2VtZW50JywgJ0FjY291bnRzJ10pLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3B1cmNoYXNlT3JkZXJSZXF1aXNpdGlvbnMucmVxdWlzaXRpb24nLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdhc3NpZ25lZF91c2VyX2lkJywgYXV0aCgpLT51c2VyKCktPmlkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KQogICAgICAgICAgICAvLyAtPndoZXJlSGFzKCdyZWxTdXBwbGllclBheW1lbnRzJyxmdW5jdGlvbiAoJHF1ZXJ5KXsKICAgICAgICAgICAgLy8gICAgICRxdWVyeS0+d2hlcmVSYXcoJ3B1cmNoYXNlX29yZGVycy5pZD1zdXBwbGllcl9wYXltZW50cy5wdXJjaGFzZV9vcmRlcl9pZCcpOwogICAgICAgICAgICAvLyB9KQogICAgICAgICAgICAtPndoZXJlSW4oJ2hyX3VuaXRfaWQnLCBhdXRoKCktPnVzZXIoKS0+cHJpb3JpdGllcy0+cGx1Y2soJ2hyX3VuaXRfaWQnKS0+dG9BcnJheSgpKQogICAgICAgICAgICAtPndoZXJlSGFzKCdyZWxRdW90YXRpb24nLGZ1bmN0aW9uICgkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3R5cGUnLCdkaXJlY3QtcHVyY2hhc2UnKS0+d2hlcmUoJ3N0YXR1cycsJ2FjdGl2ZScpCiAgICAgICAgICAgICAgICAtPndoZXJlKCdpc19hcHByb3ZlZCcsJ2FwcHJvdmVkJyktPndoZXJlKCdpc19wb19nZW5lcmF0ZScsJ3llcycpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZW4oIWVtcHR5KCRjYXNoX3N0YXR1cyksIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRjYXNoX3N0YXR1cyl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnY2FzaF9zdGF0dXMnLCAkY2FzaF9zdGF0dXMpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZW4oIWVtcHR5KCRpc19zZW5kKSwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGlzX3NlbmQpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2lzX3NlbmQnLCAkaXNfc2VuZCk7CiAgICAgICAgICAgIH0pLT53aGVuKCFkYXRhdGFibGVPcmRlcmluZygpLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaWQnLCAnZGVzYycpOwogICAgICAgICAgICB9KTsKCgogICAgICAgICAgICBpZiAocmVxdWVzdCgpLT5hamF4KCkpIHsKICAgICAgICAgICAgICAgICRvcHRpb25zID0gWwogICAgICAgICAgICAgICAgICAgICdwby1jYXNoLXBlcm1pc3Npb24nID0+IGF1dGgoKS0+dXNlcigpLT5oYXNQZXJtaXNzaW9uVG8oJ3BvLWNhc2gtcGVybWlzc2lvbicpCiAgICAgICAgICAgICAgICBdOwoKICAgICAgICAgICAgICAgIHJldHVybiBEYXRhdGFibGVzOjpvZigkcHVyY2hhc2VPcmRlcikKICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQogICAgICAgICAgICAgICAgLT5lZGl0Q29sdW1uKCdwb19kYXRlJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGUoJ1ktbS1kJywgc3RydG90aW1lKCR2YWx1ZXMtPnBvX2RhdGUpKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncG9fZGF0ZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgncG9fZGF0ZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbigncG9fZGF0ZScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyQnkoJ3BvX2RhdGUnLCAkb3JkZXIpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbigncmVmZXJlbmNlX25vJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAnPGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiBvbmNsaWNrPSJwdXJjaGFzZU9yZGVyRGV0YWlscygkKHRoaXMpKSIgY2xhc3M9ImJ0biBidG4tbGluayIgZGF0YS1zcmM9Iicucm91dGUoJ3Btcy5wdXJjaGFzZS5vcmRlci1saXN0LnNob3cnLCR2YWx1ZXMtPmlkKS4nIj4nLiR2YWx1ZXMtPnJlZmVyZW5jZV9uby4nPC9hPic7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3N1cHBsaWVyJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICBpc3NldCgkdmFsdWVzLT5yZWxRdW90YXRpb24tPnJlbFN1cHBsaWVycykgPyAoaXNzZXQoJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPm5hbWUpID8gJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPm5hbWUuJyAoJy4kdmFsdWVzLT5yZWxRdW90YXRpb24tPnJlbFN1cHBsaWVycy0+Y29kZS4nKScgOiAnJykgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignc3VwcGxpZXInLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdyZWxRdW90YXRpb24ucmVsU3VwcGxpZXJzJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+b3JXaGVyZSgnY29kZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignc3VwcGxpZXInLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBRdW90YXRpb25zOjpzZWxlY3QoJ3N1cHBsaWVycy5uYW1lJykKICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdzdXBwbGllcnMnLCAnc3VwcGxpZXJzLmlkJywgJz0nLCAncXVvdGF0aW9ucy5zdXBwbGllcl9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ3F1b3RhdGlvbnMuaWQnLCAncHVyY2hhc2Vfb3JkZXJzLnF1b3RhdGlvbl9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+dGFrZSgxKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3F1b3RhdGlvbl9yZWZfbm8nLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWZlcmVuY2Vfbm8pPyR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVmZXJlbmNlX25vOicnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdxdW90YXRpb25fcmVmX25vJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ3JlZmVyZW5jZV9ubycsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbigncXVvdGF0aW9uX3JlZl9ubycsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIFF1b3RhdGlvbnM6OnNlbGVjdCgncXVvdGF0aW9ucy5yZWZlcmVuY2Vfbm8nKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdxdW90YXRpb25zLmlkJywgJ3B1cmNoYXNlX29yZGVycy5xdW90YXRpb25faWQnKQogICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbigndG90YWxfcHJpY2UnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChpc3NldCgkdmFsdWVzLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPnN5bWJvbCk/JHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2w6JycpLicgJy5zeXN0ZW1Nb25leUZvcm1hdCgkdmFsdWVzLT50b3RhbF9wcmljZSkpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbigndmF0JywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoaXNzZXQoJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2wpPyR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+ZXhjaGFuZ2VSYXRlLT5jdXJyZW5jeS0+c3ltYm9sOicnKS4nICcuc3lzdGVtTW9uZXlGb3JtYXQoJHZhbHVlcy0+dmF0KSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5lZGl0Q29sdW1uKCdncm9zc19wcmljZScsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoKGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+ZXhjaGFuZ2VSYXRlLT5jdXJyZW5jeS0+c3ltYm9sKT8kdmFsdWVzLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPnN5bWJvbDonJykgLicgJy5zeXN0ZW1Nb25leUZvcm1hdCgkdmFsdWVzLT5ncm9zc19wcmljZSkpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdzdGF0dXMnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICAkc3RhdHVzID0gJyc7CiAgICAgICAgICAgICAgICAgICAgaWYgKCR2YWx1ZXMtPmNhc2hfc3RhdHVzPT0nYXBwcm92ZWQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRzdGF0dXMgLj0nPGJ1dHRvbiB0aXRsZT0iQXBwcm92ZWQiIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1wcmltYXJ5IG1yLTEiPjxpIGNsYXNzPSJsYXMgbGEtY2hlY2siPjwvaT48L2J1dHRvbj4nOwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB9ZWxzZWlmKCR2YWx1ZXMtPmNhc2hfc3RhdHVzPT0ncGVuZGluZycpewogICAgICAgICAgICAgICAgICAgICAgICAkc3RhdHVzIC49JzxidXR0b24gdGl0bGU9IlBlbmRpbmciICBjbGFzcz0iYnRuIGJ0bi14cyBidG4td2FybmluZyBtci0xIj48aSBjbGFzcz0ibGFzIGxhLWNsb2NrIj48L2k+PC9idXR0b24+JzsKICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXR1cyAuPSc8YnV0dG9uICB0aXRsZT0iSGFsdCIgY2xhc3M9ImJ0biBidG4teHMgYnRuLWRhbmdlciBtci0xIj48aSBjbGFzcz0ibGFzIGxhLWJhbiI+PC9pPjwvYnV0dG9uPic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRzdGF0dXMgLj0nPGEgdGFyZ2V0PSJfX2JsYW5rIiBocmVmPSInLnJvdXRlKCdwbXMuYmlsbGluZy1hdWRpdC5wby5pbnZvaWNlLnByaW50JywkdmFsdWVzLT5pZCkuJyIgY2xhc3M9ImJ0biBidG4teHMgYnRuLXN1Y2Nlc3MiPjxpIGNsYXNzPSJsYXMgbGEtcHJpbnQiPjwvaT48L2E+JzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHN0YXR1czsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYWN0aW9ucycsIGZ1bmN0aW9uKCR2YWx1ZXMpIHVzZSgkb3B0aW9ucyl7CiAgICAgICAgICAgICAgICAgICAgJGFjdGlvbnMgPSAnJzsKICAgICAgICAgICAgICAgICAgICBpZiAoJG9wdGlvbnNbJ3BvLWNhc2gtcGVybWlzc2lvbiddKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkdmFsdWVzLT5jYXNoX3N0YXR1cyE9J2FwcHJvdmVkJykgewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb25zLj0nPGRpdiBjbGFzcz0iYnRuLWdyb3VwIj48YnV0dG9uIGNsYXNzPSJidG4gZHJvcGRvd24tdG9nZ2xlIiBkYXRhLXRvZ2dsZT0iZHJvcGRvd24iPjxzcGFuIGlkPSJzdGF0dXNOYW1lJy4kdmFsdWVzLT5pZC4nIj4nLiB1Y2ZpcnN0KCR2YWx1ZXMtPmNhc2hfc3RhdHVzKS4nPC9zcGFuPjwvYnV0dG9uPjx1bCBjbGFzcz0iZHJvcGRvd24tbWVudSI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJpbmdTdGF0dXNBcnJheSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yZWFjaChzdHJpbmdTdGF0dXNBcnJheSgpIGFzICRrZXkgPT4gJHN0YXR1cyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb25zIC49JzxsaT48YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiIGNsYXNzPSJ1cGRhdGVDYXNoU3RhdHVzIiBkYXRhLWlkPSInLiR2YWx1ZXMtPmlkLiciIGRhdGEtc3RhdHVzPSInLiRrZXkuJyIgdGl0bGU9IkNsaWNrIEhlcmUgVG8gJy4kc3RhdHVzLiciIG9uQ2xpY2s9InVwZGF0ZUNhc2hTdGF0dXMoJCh0aGlzKSkiPiAnLiAkc3RhdHVzLic8L2E+PC9saT4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb25zLj0nPC91bD48L2Rpdj4nOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJHJlcXVpc2l0aW9uSWQgPSAkdmFsdWVzLT5yZWxRdW90YXRpb24tPnJlbFJlcXVlc3RQcm9wb3NhbC0+cmVxdWVzdFByb3Bvc2FsUmVxdWlzaXRpb24tPmZpcnN0KCktPnJlcXVpc2l0aW9uX2lkOwogICAgICAgICAgICAgICAgICAgIGlmICgkcmVxdWlzaXRpb25JZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyAuPSAnPGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiB0aXRsZT0iVHJhY2sgUHJvZ3Jlc3MiCiAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0idHJhY2tpbmdSZXF1aXN0aW9uU3RhdHVzIGJ0biBidG4teHMgYnRuLXNlY29uZGFyeSBtbC0yIG1yLTEiIG9uY2xpY2s9InRyYWNrUmVxdWlzaXRpb25Qcm9ncmVzcygkKHRoaXMpKSIgZGF0YS1pZD0iJyAuICRyZXF1aXNpdGlvbklkIC4gJyI+PGkgY2xhc3M9ImxhIGxhLW1hcCI+PC9pPjwvYT4nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGFjdGlvbnM7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5yYXdDb2x1bW5zKFsncmVmZXJlbmNlX25vJywnc3VwcGxpZXInLCd0b3RhbF9wcmljZScsJ3ZhdCcsJ2dyb3NzX3ByaWNlJywnc3RhdHVzJywnYWN0aW9ucyddKQogICAgICAgICAgICAgICAgLT5tYWtlKHRydWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuY2FzaC1hcHByb3ZhbC5wby1jYXNoLWFwcHJvdmFsJywgWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAkdGl0bGUsCiAgICAgICAgICAgICAgICAnY2FzaF9zdGF0dXMnID0+ICRjYXNoX3N0YXR1cywKICAgICAgICAgICAgICAgICdoZWFkZXJDb2x1bW5zJyA9PiAkdGhpcy0+aGVhZGVyQ29sdW1ucygpCiAgICAgICAgICAgIF0pOwoKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTaG93IHRoZSBmb3JtIGZvciBjcmVhdGluZyBhIG5ldyByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXENvbnRyYWN0c1xGb3VuZGF0aW9uXEFwcGxpY2F0aW9ufFxJbGx1bWluYXRlXENvbnRyYWN0c1xWaWV3XEZhY3Rvcnl8XElsbHVtaW5hdGVcQ29udHJhY3RzXFZpZXdcVmlld3xcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgIHRyeXsKICAgICAgICAgICAgJHB1cmNoYXNlT3JkZXIgPSBQdXJjaGFzZU9yZGVyOjpmaW5kT3JGYWlsKHJlcXVlc3QoKS0+Z2V0KCdwdXJjaGFzZV9vcmRlcl9pZCcpKTsKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLmNhc2gtYXBwcm92YWwuYXBwcm92YWwnLCBbCiAgICAgICAgICAgICAgICAncHVyY2hhc2Vfb3JkZXJfaWQnID0+IHJlcXVlc3QoKS0+Z2V0KCdwdXJjaGFzZV9vcmRlcl9pZCcpLAogICAgICAgICAgICAgICAgJ3BvX2Nhc2hfc3RhdHVzJyA9PiByZXF1ZXN0KCktPmdldCgncG9fY2FzaF9zdGF0dXMnKSwKICAgICAgICAgICAgICAgICdwdXJjaGFzZU9yZGVyJyA9PiAkcHVyY2hhc2VPcmRlciwKICAgICAgICAgICAgICAgICdjb3N0Q2VudHJlcycgPT4gQ29zdENlbnRyZTo6d2hlcmUoWwogICAgICAgICAgICAgICAgICAgICdocl91bml0X2lkJyA9PiAkcHVyY2hhc2VPcmRlci0+aHJfdW5pdF9pZCwKICAgICAgICAgICAgICAgICAgICAnaHJfZGVwYXJ0bWVudF9pZCcgPT4gJHB1cmNoYXNlT3JkZXItPnB1cmNoYXNlT3JkZXJSZXF1aXNpdGlvbnNbMF0tPnJlcXVpc2l0aW9uLT5yZWxVc2Vyc0xpc3QtPmVtcGxveWVlLT5hc19kZXBhcnRtZW50X2lkLAogICAgICAgICAgICAgICAgXSktPmdldCgpLAogICAgICAgICAgICBdKTsKICAgICAgICB9IGNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGgtPmdldE1lc3NhZ2UoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTdG9yZSBhIG5ld2x5IGNyZWF0ZWQgcmVzb3VyY2UgaW4gc3RvcmFnZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIFxJbGx1bWluYXRlXEh0dHBcUmVxdWVzdCAgJHJlcXVlc3QKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RvcmUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkaXNfc2VuZCA9ICgkcmVxdWVzdC0+Y2FzaF9zdGF0dXM9PSdwZW5kaW5nJyB8fCAkcmVxdWVzdC0+Y2FzaF9zdGF0dXM9PSdoYWx0Jyk/J25vJzoneWVzJzsKCiAgICAgICAgJHB1cmNoYXNlT3JkZXIgPSBQdXJjaGFzZU9yZGVyOjp3aGVyZUhhcygncmVsUXVvdGF0aW9uJyxmdW5jdGlvbiAoJHF1ZXJ5KXsKICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgndHlwZScsJ2RpcmVjdC1wdXJjaGFzZScpLT53aGVyZSgnc3RhdHVzJywnYWN0aXZlJykKICAgICAgICAgICAgLT53aGVyZSgnaXNfYXBwcm92ZWQnLCdhcHByb3ZlZCcpLT53aGVyZSgnaXNfcG9fZ2VuZXJhdGUnLCd5ZXMnKTsKICAgICAgICB9KQogICAgICAgIC0+d2hlcmUoJ2lkJywkcmVxdWVzdC0+aWQpCiAgICAgICAgLT5maXJzdCgpOwoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICgkcHVyY2hhc2VPcmRlcikgewogICAgICAgICAgICAgICAgJHB1cmNoYXNlT3JkZXItPnVwZGF0ZShbCiAgICAgICAgICAgICAgICAgICAgJ2lzX3NlbmQnPT4kaXNfc2VuZCwKICAgICAgICAgICAgICAgICAgICAnY2FzaF9zdGF0dXMnID0+ICRyZXF1ZXN0LT5jYXNoX3N0YXR1cywKICAgICAgICAgICAgICAgICAgICAnY2FzaF9ub3RlJyA9PiAkcmVxdWVzdC0+Y2FzaF9ub3RlLAogICAgICAgICAgICAgICAgICAgICdjb3N0X2NlbnRyZV9pZCcgPT4gaXNzZXQoJHJlcXVlc3QtPmNvc3RfY2VudHJlX2lkKSA/ICRyZXF1ZXN0LT5jb3N0X2NlbnRyZV9pZCA6ICRwdXJjaGFzZU9yZGVyLT5jb3N0X2NlbnRyZV9pZCwKICAgICAgICAgICAgICAgIF0pOyAKCiAgICAgICAgICAgICAgICAkbWVzc2FnZSA9ICc8c3BhbiBjbGFzcz0ibm90aWZpY2F0aW9uLWxpbmtzIiBkYXRhLXNyYz0iJy5yb3V0ZSgncG1zLnF1b3RhdGlvbi5xdW90YXRpb25zLmNzLnByb3Bvc2FsLmRldGFpbHMnLCRwdXJjaGFzZU9yZGVyLT5pZCkuJyIgZGF0YS10aXRsZT0iUHVyY2hhc2UgT3JkZXIgRGV0YWlscyI+UmVmZXJlbmNlIE5vOicuJHB1cmNoYXNlT3JkZXItPnJlZmVyZW5jZV9uby4nLkNhc2ggJy51Y2ZpcnN0KCRyZXF1ZXN0LT5jYXNoX3N0YXR1cykuJyBCeSBBY2NvdW50cy48L3NwYW4+JzsKCiAgICAgICAgICAgICAgICBDcmVhdGVPclVwZGF0ZU5vdGlmaWNhdGlvbigkbWVzc2FnZSwgJ3VucmVhZCcsICcnLCBnZXRNYW5hZ2VySW5mbygnUHVyY2hhc2UtRGVwYXJ0bWVudCcsIG51bGwsIHRydWUpLCAnc2VudC10by1wdXJjaGFzZScpOwoKICAgICAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIkNhc2ggQXBwcm92YWwgYWN0aW9uIGhhcyBiZWVuIGRvbmUgc3VjY2Vzc2Z1bGx5LiIKICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAnU29ycnkhISBQdXJjaGFzZSBPcmRlciBOb3QgRm91bmQhJwogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXNwbGF5IHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzaG93KCRpZCkKICAgIHsKICAgICAgICAvLwogICAgfQoKICAgIC8qKgogICAgICogU2hvdyB0aGUgZm9ybSBmb3IgZWRpdGluZyB0aGUgc3BlY2lmaWVkIHJlc291cmNlLgogICAgICoKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZWRpdCgkaWQpCiAgICB7CiAgICAgICAgLy8KICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgc3BlY2lmaWVkIHJlc291cmNlIGluIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3QgICRyZXF1ZXN0CiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAgLy8KICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB0aGUgc3BlY2lmaWVkIHJlc291cmNlIGZyb20gc3RvcmFnZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGRlc3Ryb3koJGlkKQogICAgewogICAgICAgIC8vCiAgICB9Cn0K