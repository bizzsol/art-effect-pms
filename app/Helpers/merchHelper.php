<?php
bolt_decrypt( __FILE__ , 'GZzXID'); return 0;
##!!!##Cgp1c2UgQXBwXE1vZGVsc1xNZXJjaFxPcmRlckVudHJ5Owp1c2UgQ2FyYm9uXENhcmJvbjsKdXNlIElsbHVtaW5hdGVcU3VwcG9ydFxGYWNhZGVzXERCOwoKaWYoIWZ1bmN0aW9uX2V4aXN0cygnaXRlbV9jYXRlZ29yeV9ieV9pZCcpKXsKICAgIGZ1bmN0aW9uIGl0ZW1fY2F0ZWdvcnlfYnlfaWQoKQogICAgewogICAgICAgcmV0dXJuICBDYWNoZTo6cmVtZW1iZXIoJ2l0ZW1fY2F0ZWdvcnlfYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCdtcl9tYXRlcmlhbF9jYXRlZ29yeScpLT5nZXQoKS0+a2V5QnkoJ21jYXRfaWQnKS0+dG9BcnJheSgpOwogICAgICAgIH0pOyAgICAgIAoKICAgIH0KfQoKaWYoIWZ1bmN0aW9uX2V4aXN0cygndW9tX2J5X2lkJykpewogICAgZnVuY3Rpb24gdW9tX2J5X2lkKCkKICAgIHsKICAgICAgIHJldHVybiAgQ2FjaGU6OnJlbWVtYmVyKCd1b21fYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCd1b20nKS0+Z2V0KCktPmtleUJ5KCdpZCcpLT50b0FycmF5KCk7CiAgICAgICAgfSk7ICAgICAgCgogICAgfQp9CgppZighZnVuY3Rpb25fZXhpc3RzKCdjb3VudHJ5X2J5X2lkJykpewogICAgZnVuY3Rpb24gY291bnRyeV9ieV9pZCgpCiAgICB7CiAgICAgICByZXR1cm4gIENhY2hlOjpyZW1lbWJlcignY291bnRyeV9ieV9pZCcsIENhcmJvbjo6bm93KCktPmFkZEhvdXIoMTIpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBEQjo6dGFibGUoJ21yX2NvdW50cnknKS0+Z2V0KCktPmtleUJ5KCdjbnRfaWQnKS0+dG9BcnJheSgpOwogICAgICAgIH0pOyAgICAgIAoKICAgIH0KfQoKaWYoIWZ1bmN0aW9uX2V4aXN0cygncG9ydF9ieV9pZCcpKXsKICAgIGZ1bmN0aW9uIHBvcnRfYnlfaWQoKQogICAgewogICAgICAgcmV0dXJuICBDYWNoZTo6cmVtZW1iZXIoJ3BvcnRfYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCdjbV9wb3J0JyktPmdldCgpLT5rZXlCeSgnaWQnKS0+dG9BcnJheSgpOwogICAgICAgIH0pOyAgICAgIAoKICAgIH0KfQoKaWYoIWZ1bmN0aW9uX2V4aXN0cygncHJvZHVjdF90eXBlX2J5X2lkJykpewogICAgZnVuY3Rpb24gcHJvZHVjdF90eXBlX2J5X2lkKCkKICAgIHsKICAgICAgIHJldHVybiAgQ2FjaGU6OnJlbWVtYmVyKCdwcm9kdWN0X3R5cGVfYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCdtcl9wcm9kdWN0X3R5cGUnKS0+Z2V0KCktPmtleUJ5KCdwcmRfdHlwZV9pZCcpLT50b0FycmF5KCk7CiAgICAgICAgfSk7ICAgICAgCgogICAgfQp9CgppZighZnVuY3Rpb25fZXhpc3RzKCdzdXBwbGllcl9ieV9pZCcpKXsKICAgIGZ1bmN0aW9uIHN1cHBsaWVyX2J5X2lkKCkKICAgIHsKICAgICAgIHJldHVybiAgQ2FjaGU6OnJlbWVtYmVyKCdzdXBwbGllcl9ieV9pZCcsIENhcmJvbjo6bm93KCktPmFkZEhvdXIoMTIpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBEQjo6dGFibGUoJ21yX3N1cHBsaWVyJyktPmdldCgpLT5rZXlCeSgnc3VwX2lkJyktPnRvQXJyYXkoKTsKICAgICAgICB9KTsgICAgICAKCiAgICB9Cn0KCmlmKCFmdW5jdGlvbl9leGlzdHMoJ2FydGljbGVfYnlfaWQnKSl7CiAgICBmdW5jdGlvbiBhcnRpY2xlX2J5X2lkKCkKICAgIHsKICAgICAgIHJldHVybiAgQ2FjaGU6OnJlbWVtYmVyKCdhcnRpY2xlX2J5X2lkJywgQ2FyYm9uOjpub3coKS0+YWRkSG91cigxMiksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIERCOjp0YWJsZSgnbXJfYXJ0aWNsZScpLT5nZXQoKS0+a2V5QnkoJ2lkJyktPnRvQXJyYXkoKTsKICAgICAgICB9KTsgICAgICAKCiAgICB9Cn0KCmlmKCFmdW5jdGlvbl9leGlzdHMoJ2l0ZW1fYnlfaWQnKSl7CiAgICBmdW5jdGlvbiBpdGVtX2J5X2lkKCkKICAgIHsKICAgICAgIHJldHVybiAgQ2FjaGU6OnJlbWVtYmVyKCdpdGVtX2J5X2lkJywgQ2FyYm9uOjpub3coKS0+YWRkSG91cigxMiksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIERCOjp0YWJsZSgnbXJfY2F0X2l0ZW0nKS0+Z2V0KCktPmtleUJ5KCdpZCcpLT50b0FycmF5KCk7CiAgICAgICAgfSk7ICAgICAgCgogICAgfQp9CgppZighZnVuY3Rpb25fZXhpc3RzKCdidXllcl9ieV9pZCcpKXsKICAgIGZ1bmN0aW9uIGJ1eWVyX2J5X2lkKCkKICAgIHsKICAgICAgICAkYnV5ZXJfcGVybWlzc2lvbnMgPSBhdXRoKCktPnVzZXIoKS0+YnV5ZXJfcGVybWlzc2lvbnMoKTsKICAgICAgICAkZGF0YSA9IENhY2hlOjpyZW1lbWJlcignYnV5ZXJfYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCdtcl9idXllcicpCiAgICAgICAgICAgIC0+Z2V0KCktPmtleUJ5KCdiX2lkJyktPnRvQXJyYXkoKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gY29sbGVjdCgkZGF0YSkKICAgICAgICAtPmZpbHRlcihmdW5jdGlvbigkcSkgdXNlICgkYnV5ZXJfcGVybWlzc2lvbnMpewogICAgICAgICAgICByZXR1cm4gaW5fYXJyYXkoJHEtPmJfaWQsICRidXllcl9wZXJtaXNzaW9ucyk7CiAgICAgICAgfSkKICAgICAgICAtPnZhbHVlcygpCiAgICAgICAgLT5rZXlCeSgnYl9pZCcpOyAgICAgIAoKICAgIH0KfQppZighZnVuY3Rpb25fZXhpc3RzKCdicmFuZF9ieV9pZCcpKXsKICAgIGZ1bmN0aW9uIGJyYW5kX2J5X2lkKCkKICAgIHsKICAgICAgICAkYnV5ZXJfcGVybWlzc2lvbnMgPSBhdXRoKCktPnVzZXIoKS0+YnV5ZXJfcGVybWlzc2lvbnMoKTsKICAgICAgICAkZGF0YSA9IENhY2hlOjpyZW1lbWJlcignYnJhbmRfYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCdtcl9icmFuZCcpCiAgICAgICAgICAgIC0+Z2V0KCktPmtleUJ5KCdicl9pZCcpLT50b0FycmF5KCk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGNvbGxlY3QoJGRhdGEpCiAgICAgICAgLT5maWx0ZXIoZnVuY3Rpb24oJHEpIHVzZSAoJGJ1eWVyX3Blcm1pc3Npb25zKXsKICAgICAgICAgICAgcmV0dXJuIGluX2FycmF5KCRxLT5iX2lkLCAkYnV5ZXJfcGVybWlzc2lvbnMpOwogICAgICAgIH0pCiAgICAgICAgLT52YWx1ZXMoKQogICAgICAgIC0+a2V5QnkoJ2JyX2lkJyk7ICAgICAKCiAgICB9Cn0KCmlmKCFmdW5jdGlvbl9leGlzdHMoJ3NlYXNvbl9ieV9pZCcpKXsKICAgIGZ1bmN0aW9uIHNlYXNvbl9ieV9pZCgpCiAgICB7CiAgICAgICAgJGJ1eWVyX3Blcm1pc3Npb25zID0gYXV0aCgpLT51c2VyKCktPmJ1eWVyX3Blcm1pc3Npb25zKCk7CiAgICAgICAgJGRhdGEgPSBDYWNoZTo6cmVtZW1iZXIoJ3NlYXNvbl9ieV9pZCcsIENhcmJvbjo6bm93KCktPmFkZEhvdXIoMTIpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBEQjo6dGFibGUoJ21yX3NlYXNvbicpCiAgICAgICAgICAgIC0+Z2V0KCktPmtleUJ5KCdzZV9pZCcpLT50b0FycmF5KCk7CiAgICAgICAgfSk7ICAKICAgICAgICByZXR1cm4gY29sbGVjdCgkZGF0YSkKICAgICAgICAtPmZpbHRlcihmdW5jdGlvbigkcSkgdXNlICgkYnV5ZXJfcGVybWlzc2lvbnMpewogICAgICAgICAgICByZXR1cm4gaW5fYXJyYXkoJHEtPmJfaWQsICRidXllcl9wZXJtaXNzaW9ucyk7CiAgICAgICAgfSkKICAgICAgICAtPnZhbHVlcygpCiAgICAgICAgLT5rZXlCeSgnc2VfaWQnKTsgICAgICAKCiAgICB9Cn0KCmlmKCFmdW5jdGlvbl9leGlzdHMoJ3NhbXBsZV90eXBlX2J5X2lkJykpewogICAgZnVuY3Rpb24gc2FtcGxlX3R5cGVfYnlfaWQoKQogICAgewogICAgICAgICRidXllcl9wZXJtaXNzaW9ucyA9IGF1dGgoKS0+dXNlcigpLT5idXllcl9wZXJtaXNzaW9ucygpOwogICAgICAgICRkYXRhID0gQ2FjaGU6OnJlbWVtYmVyKCdzYW1wbGVfdHlwZV9ieV9pZCcsIENhcmJvbjo6bm93KCktPmFkZEhvdXIoMTIpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBEQjo6dGFibGUoJ21yX3NhbXBsZV90eXBlJykKICAgICAgICAgICAgLT5nZXQoKS0+a2V5QnkoJ3NhbXBsZV9pZCcpLT50b0FycmF5KCk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGNvbGxlY3QoJGRhdGEpCiAgICAgICAgLT5maWx0ZXIoZnVuY3Rpb24oJHEpIHVzZSAoJGJ1eWVyX3Blcm1pc3Npb25zKXsKICAgICAgICAgICAgcmV0dXJuIGluX2FycmF5KCRxLT5iX2lkLCAkYnV5ZXJfcGVybWlzc2lvbnMpOwogICAgICAgIH0pCiAgICAgICAgLT52YWx1ZXMoKQogICAgICAgIC0+a2V5QnkoJ3NhbXBsZV9pZCcpOyAgICAgCiAgICB9Cn0KCmlmKCFmdW5jdGlvbl9leGlzdHMoJ21hdGVyaWFsX2NvbG9yX2J5X2lkJykpewogICAgZnVuY3Rpb24gbWF0ZXJpYWxfY29sb3JfYnlfaWQoKQogICAgewogICAgICAgcmV0dXJuICBDYWNoZTo6cmVtZW1iZXIoJ21hdGVyaWFsX2NvbG9yX2J5X2lkJywgQ2FyYm9uOjpub3coKS0+YWRkSG91cigxMiksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIERCOjp0YWJsZSgnbXJfbWF0ZXJpYWxfY29sb3InKS0+Z2V0KCktPmtleUJ5KCdjbHJfaWQnKS0+dG9BcnJheSgpOwogICAgICAgIH0pOyAgICAgIAoKICAgIH0KfQoKaWYoIWZ1bmN0aW9uX2V4aXN0cygnc3BlY2lhbF9tYWNoaW5lX2J5X2lkJykpewogICAgZnVuY3Rpb24gc3BlY2lhbF9tYWNoaW5lX2J5X2lkKCkKICAgIHsKICAgICAgIHJldHVybiAgQ2FjaGU6OnJlbWVtYmVyKCdzcGVjaWFsX21hY2hpbmVfYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCdtcl9zcGVjaWFsX21hY2hpbmUnKS0+Z2V0KCktPmtleUJ5KCdzcG1hY2hpbmVfaWQnKS0+dG9BcnJheSgpOwogICAgICAgIH0pOyAgICAgIAoKICAgIH0KfQoKaWYoIWZ1bmN0aW9uX2V4aXN0cygnZ2FybWVudF90eXBlX2J5X2lkJykpewogICAgZnVuY3Rpb24gZ2FybWVudF90eXBlX2J5X2lkKCkKICAgIHsKICAgICAgIHJldHVybiAgQ2FjaGU6OnJlbWVtYmVyKCdnYXJtZW50X3R5cGVfYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCdtcl9nYXJtZW50X3R5cGUnKS0+Z2V0KCktPmtleUJ5KCdnbXRfaWQnKS0+dG9BcnJheSgpOwogICAgICAgIH0pOyAgICAgIAoKICAgIH0KfQoKaWYoIWZ1bmN0aW9uX2V4aXN0cygnc2l6ZV9ieV9pZCcpKXsKICAgIGZ1bmN0aW9uIHNpemVfYnlfaWQoKQogICAgewogICAgICAgcmV0dXJuICBDYWNoZTo6cmVtZW1iZXIoJ3NpemVfYnlfaWQnLCBDYXJib246Om5vdygpLT5hZGRIb3VyKDEyKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gREI6OnRhYmxlKCdtcl9wcm9kdWN0X3NpemUnKS0+Z2V0KCktPmtleUJ5KCdpZCcpLT50b0FycmF5KCk7CiAgICAgICAgfSk7ICAgICAgCgogICAgfQp9CmlmKCFmdW5jdGlvbl9leGlzdHMoJ2N1c3RvbV9kYXRlX2Zvcm1hdCcpKXsKICAgIGZ1bmN0aW9uIGN1c3RvbV9kYXRlX2Zvcm1hdCgkZGF0ZSl7CiAgICAgICAgcmV0dXJuICRkYXRlICE9ICcnIHx8ICRkYXRlICE9IG51bGwgPyBkYXRlKCdGIGQsIFknLCBzdHJ0b3RpbWUoJGRhdGUpKTonJzsKICAgIH0KfQoKaWYoIWZ1bmN0aW9uX2V4aXN0cygnbWFrZV9vcmRlcl9udW1iZXInKSl7CiAgICBmdW5jdGlvbiBtYWtlX29yZGVyX251bWJlcigkZGF0YSwgJHllYXIgPSBudWxsKXsKICAgICAgICAkc2Vhc29uID0gc2Vhc29uX2J5X2lkKCk7CiAgICAgICAgJGJ1eWVyID0gYnV5ZXJfYnlfaWQoKTsKICAgICAgICAkYnV5ZXJOYW1lID0gJ04vQSc7CiAgICAgICAgJHNlYXNvbk5hbWUgPSAnTi9BJzsKICAgICAgICAkeWVhclNob3J0ID0gZGF0ZSgneScpOwogICAgICAgIGlmKGlzc2V0KCRkYXRhWydiX2lkJ10pKXsKICAgICAgICAgICAgJGJ1eWVyTmFtZSA9IHN1YnN0cigkYnV5ZXJbJGRhdGFbJ2JfaWQnXV0tPmJfbmFtZSwgMCwgMyk7CiAgICAgICAgfQoKICAgICAgICBpZihpc3NldCgkZGF0YVsnbXJfc2Vhc29uX3NlX2lkJ10pKXsKICAgICAgICAgICAgJHNlYXNvbk5hbWUgPSBzdWJzdHIoJHNlYXNvblskZGF0YVsnbXJfc2Vhc29uX3NlX2lkJ11dLT5zZV9uYW1lLCAwLCAyKTsKICAgICAgICB9CiAgICAgICAgaWYoJHllYXIgIT0gJycpewogICAgICAgICAgICAkeWVhclNob3J0ID0gZGF0ZSgneScsIHN0cnRvdGltZSgkeWVhcikpOwogICAgICAgIH0KICAgICAgICAkY29kZSA9IHN0cnRvdXBwZXIoJHllYXJTaG9ydC4kc2Vhc29uTmFtZS4kYnV5ZXJOYW1lKTsKCiAgICAgICAgJG9yZGVyTm8gPSBPcmRlckVudHJ5OjpnZXRDaGVja0xhc3RPcmRlck51bWJlcigkY29kZSk7CgogICAgICAgICRzbCA9IDE7CiAgICAgICAgaWYoJG9yZGVyTm8gIT0gbnVsbCl7CiAgICAgICAgICAgICRzbCA9ICRvcmRlck5vICsgMTsKICAgICAgICB9CiAgICAgICAgJHNsID0gc3RyX3BhZCgoJHNsKSwgMywgIjAiLCBTVFJfUEFEX0xFRlQpOwogICAgICAgIHJldHVybiBjaGVja09yZGVyTnVtYmVyKCRjb2RlLCAkc2wpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoZWNrT3JkZXJOdW1iZXIoJGNvZGUsICRzbCkKICAgIHsKICAgICAgICAkY29kZU5vID0gJGNvZGUuJHNsOwogICAgICAgICRnZXRDaGVjayA9IE9yZGVyRW50cnk6OmdldENoZWNrT3JkZXJFeGlzdENvZGUoJGNvZGVObyk7CiAgICAgICAgaWYoJGdldENoZWNrID09IHRydWUpewogICAgICAgICAgICAkc2wgPSBzdHJfcGFkKCgkc2wgKyAxKSwgMywgIjAiLCBTVFJfUEFEX0xFRlQpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmNoZWNrT3JkZXJOdW1iZXIoJGNvZGUsICRzbCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkY29kZU5vOwogICAgfQp9CgppZighZnVuY3Rpb25fZXhpc3RzKCdtZXJjaGFuZGlzZXJzX3RlYW0nKSl7CgogICAgZnVuY3Rpb24gbWVyY2hhbmRpc2Vyc190ZWFtKCkKICAgIHsKCiAgICB9Cn0KCmlmKCFmdW5jdGlvbl9leGlzdHMoJ3N0eWxlX3BpY3R1cmUnKSl7CiAgICBmdW5jdGlvbiBzdHlsZV9waWN0dXJlKCRzdHlsZSkKICAgIHsKICAgICAgICAkZGVmYXVsdCA9ICcvYXNzZXRzL2ZpbGVzL3N0eWxlL3BsYWNlaG9sZGVyLnBuZyc7CgogICAgICAgIGlmKCRzdHlsZS0+c3RsX2ltZ19saW5rICE9IG51bGwgJiYgZmlsZV9leGlzdHMocHVibGljX3BhdGgoJHN0eWxlLT5zdGxfaW1nX2xpbmspKSl7CiAgICAgICAgICAgICRpbWFnZSA9ICRzdHlsZS0+c3RsX2ltZ19saW5rOwogICAgICAgIH1lbHNlewogICAgICAgICAgICAkaW1hZ2UgPSAkZGVmYXVsdDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRpbWFnZTsKICAgIH0KfQ==