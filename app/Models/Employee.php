<?php
bolt_decrypt( __FILE__ , 'DYckAT'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXE1vZGVsczsKdXNlIEFwcFxNb2RlbHNcRW1wbG95ZWU7CnVzZSBBcHBcTW9kZWxzXEhyXEJlbmVmaXRzOwp1c2UgQXBwXE1vZGVsc1xIclxMZWF2ZTsKdXNlIEFwcFxNb2RlbHNcSHJcU2hpZnQ7CnVzZSBBd29iYXpcQ29tcG9zaGlwc1xDb21wb3NoaXBzOwp1c2UgU3BhdGllXEFjdGl2aXR5bG9nXFRyYWl0c1xMb2dzQWN0aXZpdHk7CnVzZSBEQjsKdXNlIElsbHVtaW5hdGVcRGF0YWJhc2VcRWxvcXVlbnRcTW9kZWw7CnVzZSBTcGF0aWVcQWN0aXZpdHlsb2dcTG9nT3B0aW9uczsKCmNsYXNzIEVtcGxveWVlIGV4dGVuZHMgTW9kZWwKewoJdXNlIENvbXBvc2hpcHMsIExvZ3NBY3Rpdml0eTsKCiAgICBwcm90ZWN0ZWQgJHRhYmxlID0gImhyX2FzX2Jhc2ljX2luZm8iOwogICAgcHJvdGVjdGVkICRwcmltYXJ5S2V5ID0gJ2FzX2lkJzsKICAgIHByb3RlY3RlZCAkZ3VhcmRlZCA9IFtdOwoKICAgIHByb3RlY3RlZCBzdGF0aWMgJGxvZ0F0dHJpYnV0ZXMgPSBbJ2FzX2VtcF90eXBlX2lkJywgJ2FzX2Rlc2lnbmF0aW9uX2lkJywgJ2FzX3VuaXRfaWQnLCAnYXNfbG9jYXRpb24nLCAnYXNfZmxvb3JfaWQnLCAnYXNfbGluZV9pZCcsICdhc19zaGlmdF9pZCcsICdhc19hcmVhX2lkJywgJ2FzX2RlcGFydG1lbnRfaWQnLCAnYXNfc2VjdGlvbl9pZCcsICdhc19zdWJzZWN0aW9uX2lkJywgJ2FzX2RvaicsICdhc19uYW1lJywgJ2FzX2dlbmRlcicsICdhc19kb2InLCAnYXNfY29udGFjdCcsICdhc19vdCcsICdhc19zdGF0dXMnLCAnYXNfc3RhdHVzX2RhdGUnLCAnYXNfcmVtYXJrcycsICdhc19yZmlkX2NvZGUnLCAnc2hpZnRfcm9hc3Rlcl9zdGF0dXMnXTsKICAgIHByb3RlY3RlZCBzdGF0aWMgJGxvZ05hbWUgPSAnZW1wbG95ZWUnOwoKICAgIHByb3RlY3RlZCBzdGF0aWMgJGxvZ09ubHlEaXJ0eSA9IHRydWU7CgogICAgcHJvdGVjdGVkICRkYXRlcyA9IFsKICAgICAgICAnYXNfZG9qJywgJ2NyZWF0ZWRfYXQnLCAndXBkYXRlZF9hdCcsICdhc19kb2InCiAgICBdOwoKICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0RW1wbG95ZWVBc3NvY2lhdGVJZFdpc2UoJGFzX2lkKQogICAgewogICAgCXJldHVybiBFbXBsb3llZTo6d2hlcmUoJ2Fzc29jaWF0ZV9pZCcsICRhc19pZCktPmZpcnN0KCk7CiAgICB9CgogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRFbXBsb3llZUFzc0lkV2lzZVNlbGVjdGVkRmllbGQoJGFzc29jaWF0ZV9pZCwgJHNlbGVjdGVkRmllbGQpCiAgICB7CiAgICAgICAgJHF1ZXJ5ID0gREI6OnRhYmxlKCdocl9hc19iYXNpY19pbmZvJykKICAgICAgICAtPndoZXJlKCdhc3NvY2lhdGVfaWQnLCAkYXNzb2NpYXRlX2lkKTsKICAgICAgICBpZigkc2VsZWN0ZWRGaWVsZCAhPSAnYWxsJyl7CiAgICAgICAgICAgICRxdWVyeS0+c2VsZWN0KCRzZWxlY3RlZEZpZWxkKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRxdWVyeS0+Zmlyc3QoKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldEVtcGxveWVlQXNJZFdpc2VTZWxlY3RlZEZpZWxkKCRhc19pZCwgJHNlbGVjdGVkRmllbGQpCiAgICB7CiAgICAgICAgJHF1ZXJ5ID0gREI6OnRhYmxlKCdocl9hc19iYXNpY19pbmZvJykKICAgICAgICAtPndoZXJlKCdhc19pZCcsICRhc19pZCk7CiAgICAgICAgaWYoJHNlbGVjdGVkRmllbGQgIT0gJ2FsbCcpewogICAgICAgICAgICAkcXVlcnktPnNlbGVjdCgkc2VsZWN0ZWRGaWVsZCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkcXVlcnktPmZpcnN0KCk7CiAgICB9CgogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRTZWxlY3RJZE5hbWVFbXBsb3llZSgpCiAgICB7CiAgICAgICAgcmV0dXJuIEVtcGxveWVlOjpzZWxlY3QoJ2FzX2lkJywgJ2FzX25hbWUnLCAnYXNzb2NpYXRlX2lkJyktPmdldCgpOwogICAgfQogICAgCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzaWduYXRpb24oKQogICAgewogICAgCXJldHVybiAkdGhpcy0+YmVsb25nc1RvKCdBcHBcTW9kZWxzXEhyXERlc2lnbmF0aW9uJywgJ2FzX2Rlc2lnbmF0aW9uX2lkJywgJ2hyX2Rlc2lnbmF0aW9uX2lkJyk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBmdW5jdGlvbiBiZW5lZml0cygpCiAgICB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5oYXNPbmUoQmVuZWZpdHM6OmNsYXNzLCAnYmVuX2FzX2lkJywgJ2Fzc29jaWF0ZV9pZCcpOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0RW1wbG95ZWVGaWx0ZXJXaXNlKCRkYXRhKQogICAgewogICAgICAgICRxdWVyeSA9IEVtcGxveWVlOjpzZWxlY3QoJ2FzX2lkJywgJ2Fzc29jaWF0ZV9pZCcsICdhc191bml0X2lkJywgJ2FzX2xvY2F0aW9uJyk7CiAgICAgICAgaWYoJGRhdGFbJ3VuaXQnXSl7CiAgICAgICAgICAgIGlmKCRkYXRhWyd1bml0J10gPT0gMSl7CiAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlSW4oJ2FzX3VuaXRfaWQnLCBbMSw0LDVdKTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdhc191bml0X2lkJywgJGRhdGFbJ3VuaXQnXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gJHF1ZXJ5LT5vcldoZXJlKCdhc19sb2NhdGlvbicsICRkYXRhWyd1bml0J10pOwogICAgICAgIH0KICAgICAgICBpZihpc3NldCgkZGF0YVsnZmxvb3InXSkpewogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdhc19mbG9vcl9pZCcsICRkYXRhWydmbG9vciddKTsKICAgICAgICB9CiAgICAgICAgaWYoaXNzZXQoJGRhdGFbJ3NlY3Rpb24nXSkpewogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdhc19zZWN0aW9uX2lkJywgJGRhdGFbJ3NlY3Rpb24nXSk7CiAgICAgICAgfQogICAgICAgIGlmKGlzc2V0KCRkYXRhWydzdWJfc2VjdGlvbiddKSl7CiAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2FzX3N1YnNlY3Rpb25faWQnLCAkZGF0YVsnc3ViX3NlY3Rpb24nXSk7CiAgICAgICAgfQogICAgICAgIGlmKGlzc2V0KCRkYXRhWydhcmVhJ10pKXsKICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnYXNfYXJlYV9pZCcsICRkYXRhWydhcmVhJ10pOwogICAgICAgIH0KICAgICAgICBpZihpc3NldCgkZGF0YVsnZGVwYXJ0bWVudCddKSl7CiAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2FzX2RlcGFydG1lbnRfaWQnLCAkZGF0YVsnZGVwYXJ0bWVudCddKTsKICAgICAgICB9CiAgICAgICAgaWYoaXNzZXQoJGRhdGFbJ2VtcGxveWVlX3N0YXR1cyddKSl7CiAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2FzX3N0YXR1cycsKGludCkkZGF0YVsnZW1wbG95ZWVfc3RhdHVzJ10pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJHF1ZXJ5LT5nZXQoKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gdW5pdCgpCiAgICB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5iZWxvbmdzVG8oJ0FwcFxNb2RlbHNcSHJcVW5pdCcsICdhc191bml0X2lkJywgJ2hyX3VuaXRfaWQnKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZmxvb3IoKQogICAgewogICAgICAgIHJldHVybiAkdGhpcy0+YmVsb25nc1RvKCdBcHBcTW9kZWxzXEhyXEZsb29yJywgJ2FzX2Zsb29yX2lkJywgJ2hyX2Zsb29yX2lkJyk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGRlcGFydG1lbnQoKQogICAgewogICAgICAgIHJldHVybiAkdGhpcy0+YmVsb25nc1RvKCdBcHBcTW9kZWxzXEhyXERlcGFydG1lbnQnLCAnYXNfZGVwYXJ0bWVudF9pZCcsICdocl9kZXBhcnRtZW50X2lkJyk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHNlY3Rpb24oKQogICAgewogICAgICAgIHJldHVybiAkdGhpcy0+YmVsb25nc1RvKCdBcHBcTW9kZWxzXEhyXFNlY3Rpb24nLCAnYXNfc2VjdGlvbl9pZCcsICdocl9zZWN0aW9uX2lkJyk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGxpbmUoKQogICAgewogICAgICAgIHJldHVybiAkdGhpcy0+YmVsb25nc1RvKCdBcHBcTW9kZWxzXEhyXExpbmUnLCAnYXNfbGluZV9pZCcsICdocl9saW5lX2lkJyk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGxvY2F0aW9uKCkKICAgIHsKICAgICAgICByZXR1cm4gJHRoaXMtPmhhc09uZSgnQXBwXE1vZGVsc1xIclxMb2NhdGlvbicsICdocl9sb2NhdGlvbl9pZCcsICdhc19sb2NhdGlvbicpOwogICAgfQoKICAgIC8vIHB1YmxpYyBmdW5jdGlvbiBzaGlmdCgpCiAgICAvLyB7CiAgICAvLyAgICAgcmV0dXJuICR0aGlzLT5oYXNPbmUoJ0FwcFxNb2RlbHNcSHJcU2hpZnQnLCAnaHJfc2hpZnRfaWQnLCAnYXNfc2hpZnRfaWQnKTsKICAgIC8vIH0KICAgIHB1YmxpYyBmdW5jdGlvbiBzaGlmdCgpCiAgICB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5iZWxvbmdzVG8oU2hpZnQ6OmNsYXNzLCBbJ2FzX3VuaXRfaWQnLCAnYXNfc2hpZnRfaWQnXSwgWydocl9zaGlmdF91bml0X2lkJywgJ2hyX3NoaWZ0X25hbWUnXSktPmxhdGVzdCgpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBnZXRfc2hpZnRfbmFtZSgpCiAgICB7CiAgICAgICAgcmV0dXJuIFNoaWZ0OjpzZWxlY3QoJ2hyX3NoaWZ0X2lkJywnaHJfc2hpZnRfbmFtZScsJ2hyX3NoaWZ0X3VuaXRfaWQnKS0+bGF0ZXN0KCktPmdldCgpLT5ncm91cEJ5KCdocl9zaGlmdF9uYW1lJywnaHJfc2hpZnRfdW5pdF9pZCcpLT50b0FycmF5KCk7CgogICAgICAgIC8vIGRkKCRzaGlmdHMpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzYWxhcnkoKQogICAgewogICAgICAgIHJldHVybiAkdGhpcy0+YmVsb25nc1RvKCdBcHBcTW9kZWxzXEhyXEhyTW9udGhseVNhbGFyeScsICdhc3NvY2lhdGVfaWQnLCAnYXNfaWQnKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZW1wbG95ZWVfYmVuZ2FsaSgpCiAgICB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5iZWxvbmdzVG8oJ0FwcFxNb2RlbHNcSHJcRW1wbG95ZWVCZW5nYWxpJywgJ2Fzc29jaWF0ZV9pZCcsICdocl9ibl9hc3NvY2lhdGVfaWQnKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldFNpbmdsZUVtcGxveWVlV2lzZVNhbGFyeVNoZWV0KCRkYXRhKQogICAgewogICAgICAgICRxdWVyeSA9IEVtcGxveWVlOjoKICAgICAgICB3aGVyZSgnaHJfYXNfYmFzaWNfaW5mby5hc3NvY2lhdGVfaWQnLCAkZGF0YVsnYXNfaWQnXSkKICAgICAgICAvLyAtPndoZXJlSGFzKCdzYWxhcnknLCBmdW5jdGlvbigkcXVlcnkpIHVzZSAoJGRhdGEpCiAgICAgICAgLy8gewogICAgICAgIC8vICAgICAkcXVlcnktPndoZXJlKCd5ZWFyJywgJz49JywgJGRhdGFbJ2Zvcm1ZZWFyJ10pOwogICAgICAgIC8vICAgICAkcXVlcnktPndoZXJlKCd5ZWFyJywgJzw9JywgJGRhdGFbJ3RvWWVhciddKTsKICAgICAgICAvLyAgICAgJHF1ZXJ5LT53aGVyZSgnbW9udGgnLCAnPj0nLCAkZGF0YVsnZm9ybU1vbnRoJ10pOwogICAgICAgIC8vICAgICAkcXVlcnktPndoZXJlKCdtb250aCcsICc8PScsICRkYXRhWyd0b01vbnRoJ10pOwogICAgICAgIC8vIH0pCiAgICAgICAgLT53aXRoKGFycmF5KCdzYWxhcnknPT5mdW5jdGlvbigkcXVlcnkpIHVzZSAoJGRhdGEpewogICAgICAgICAgICAkcXVlcnktPndoZXJlKCd5ZWFyJywgJz49JywgJGRhdGFbJ2Zvcm1ZZWFyJ10pOwogICAgICAgICAgICAkcXVlcnktPndoZXJlKCd5ZWFyJywgJzw9JywgJGRhdGFbJ3RvWWVhciddKTsKICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbW9udGgnLCAnPj0nLCAkZGF0YVsnZm9ybU1vbnRoJ10pOwogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdtb250aCcsICc8PScsICRkYXRhWyd0b01vbnRoJ10pOwogICAgICAgICB9KSk7CgogICAgICAgIHJldHVybiAkcXVlcnk7CiAgICB9CgogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRFbXBsb3llZVdpc2VTYWxhcnlTaGVldCgkZGF0YSkKICAgIHsKCiAgICAgIGlmKGF1dGgoKS0+dXNlcigpLT5oYXNSb2xlKCdwb3dlciB1c2VyIDMnKSl7CiAgICAgICAgJGNhbnRhY2NlcyA9IFsncG93ZXIgdXNlciAyJywnYWR2YW5jZSB1c2VyIDInXTsKICAgICAgfWVsc2VpZiAoYXV0aCgpLT51c2VyKCktPmhhc1JvbGUoJ3Bvd2VyIHVzZXIgMicpKSB7CiAgICAgICAgJGNhbnRhY2NlcyA9IFsncG93ZXIgdXNlciAzJywnYWR2YW5jZSB1c2VyIDInXTsKICAgICAgfWVsc2VpZiAoYXV0aCgpLT51c2VyKCktPmhhc1JvbGUoJ2FkdmFuY2UgdXNlciAyJykpIHsKICAgICAgICAkY2FudGFjY2VzID0gWydwb3dlciB1c2VyIDMnLCdwb3dlciB1c2VyIDInXTsKICAgICAgfWVsc2V7CiAgICAgICAgJGNhbnRhY2NlcyA9IFtdOwogICAgICB9CiAgICAKICAgICAgICAkeWVhck1vbnRoID0gJGRhdGFbJ3llYXInXS4nICcuJGRhdGFbJ21vbnRoJ107CiAgICAgIAogICAgICAgICR1c2VySWROb3RBY2Nlc3NpYmxlID0gREI6OnRhYmxlKCdyb2xlcycpCiAgICAgICAgICAgICAgICAtPndoZXJlSW4oJ25hbWUnLCRjYW50YWNjZXMpCiAgICAgICAgICAgICAgICAtPmxlZnRKb2luKCdtb2RlbF9oYXNfcm9sZXMnLCdyb2xlcy5pZCcsJ21vZGVsX2hhc19yb2xlcy5yb2xlX2lkJykKICAgICAgICAgICAgICAgIC0+cGx1Y2soJ21vZGVsX2hhc19yb2xlcy5tb2RlbF9pZCcpOwoKICAgICAgICAkYXNJZHMgPSBEQjo6dGFibGUoJ3VzZXJzJykKICAgICAgICAgICAgICAgICAgIC0+d2hlcmVJbignaWQnLCR1c2VySWROb3RBY2Nlc3NpYmxlKQogICAgICAgICAgICAgICAgICAgLT5wbHVjaygnYXNzb2NpYXRlX2lkJyk7CgogICAgICAgICRxdWVyeSA9IEVtcGxveWVlOjp3aGVyZSgnaHJfYXNfYmFzaWNfaW5mby5hc191bml0X2lkJywgJGRhdGFbJ3VuaXQnXSkKICAgICAgICAtPndoZXJlTm90SW4oJ2hyX2FzX2Jhc2ljX2luZm8uYXNzb2NpYXRlX2lkJywkYXNJZHMpCiAgICAgICAgLT53aGVyZSgnaHJfYXNfYmFzaWNfaW5mby5hc19zdGF0dXMnLCAkZGF0YVsnZW1wbG95ZWVfc3RhdHVzJ10pCiAgICAgICAgLT53aGVyZShEQjo6cmF3KCIoREFURV9GT1JNQVQoYXNfZG9qLCclWS0lbScpKSIpLCAnPD0nLCR5ZWFyTW9udGgpCiAgICAgICAgLT53aXRoKGFycmF5KCdzYWxhcnknPT5mdW5jdGlvbigkcXVlcnkpIHVzZSAoJGRhdGEpCiAgICAgICAgewogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdtb250aCcsICRkYXRhWydtb250aCddKTsKICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgneWVhcicsICRkYXRhWyd5ZWFyJ10pOwogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdncm9zcycsICc+PScsICRkYXRhWydtaW5fc2FsJ10pOwogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdncm9zcycsICc8PScsICRkYXRhWydtYXhfc2FsJ10pOwogICAgICAgICAgICBpZihpc3NldCgkZGF0YVsnZGlzYnVyc2VkJ10pICYmICRkYXRhWydkaXNidXJzZWQnXSAhPSBudWxsKXsKICAgICAgICAgICAgICAgIGlmKCRkYXRhWydkaXNidXJzZWQnXSA9PSAxKXsKICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdkaXNidXJzZV9kYXRlJywgJyE9JywgbnVsbCk7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdkaXNidXJzZV9kYXRlJywgbnVsbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KSk7CiAgICAgICAgaWYoJGRhdGFbJ2Zsb29yJ10pewogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdocl9hc19iYXNpY19pbmZvLmFzX2Zsb29yX2lkJywgJGRhdGFbJ2Zsb29yJ10pOwogICAgICAgIH0KCiAgICAgICAgaWYoJGRhdGFbJ2FyZWEnXSl7CiAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2hyX2FzX2Jhc2ljX2luZm8uYXNfYXJlYV9pZCcsICRkYXRhWydhcmVhJ10pOwogICAgICAgIH0KCiAgICAgICAgaWYoJGRhdGFbJ2RlcGFydG1lbnQnXSl7CiAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2hyX2FzX2Jhc2ljX2luZm8uYXNfZGVwYXJ0bWVudF9pZCcsICRkYXRhWydkZXBhcnRtZW50J10pOwogICAgICAgIH0KCiAgICAgICAgaWYoJGRhdGFbJ3NlY3Rpb24nXSl7CiAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2hyX2FzX2Jhc2ljX2luZm8uYXNfc2VjdGlvbl9pZCcsICRkYXRhWydzZWN0aW9uJ10pOwogICAgICAgIH0KCiAgICAgICAgaWYoJGRhdGFbJ3N1Yl9zZWN0aW9uJ10pewogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdocl9hc19iYXNpY19pbmZvLmFzX3N1YnNlY3Rpb25faWQnLCAkZGF0YVsnc3ViX3NlY3Rpb24nXSk7CiAgICAgICAgfQoKICAgICAgICBpZihpc3NldCgkZGF0YVsnYXNfb3QnXSkpewogICAgICAgICAgICAkcXVlcnktPndoZXJlKCdocl9hc19iYXNpY19pbmZvLmFzX290JywgJGRhdGFbJ2FzX290J10pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJHF1ZXJ5OwoKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldFNlYXJjaEtleVdpc2UoJHZhbHVlKQogICAgewogICAgICAgIHJldHVybiBFbXBsb3llZTo6CiAgICAgICAgd2hlcmUoJ2Fzc29jaWF0ZV9pZCcsICdMSUtFJywgJyUnLiAkdmFsdWUgLiclJykKICAgICAgICAtPndoZXJlSW4oJ2FzX3VuaXRfaWQnLCBhdXRoKCktPnVzZXIoKS0+dW5pdF9wZXJtaXNzaW9ucygpKQogICAgICAgIC0+d2hlcmVJbignYXNfbG9jYXRpb24nLCBhdXRoKCktPnVzZXIoKS0+bG9jYXRpb25fcGVybWlzc2lvbnMoKSkKICAgICAgICAtPm9yV2hlcmUoJ2FzX25hbWUnLCAnTElLRScsICclJy4gJHZhbHVlIC4gJyUnKQogICAgICAgIC0+b3JXaGVyZSgnYXNfb3JhY2xlX2NvZGUnLCAnTElLRScsICclJy4gJHZhbHVlIC4gJyUnKQogICAgICAgIC0+cGFnaW5hdGUoMTApOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0U2VhcmNoR2xvYmFsS2V5V2lzZSgkdmFsdWUpCiAgICB7CiAgICAgICAgcmV0dXJuIERCOjp0YWJsZSgnaHJfYXNfYmFzaWNfaW5mbycpCiAgICAgICAgLT5zZWxlY3QoJ2FzX25hbWUnLCAnYXNzb2NpYXRlX2lkJykKICAgICAgICAtPndoZXJlSW4oJ2FzX3VuaXRfaWQnLCBhdXRoKCktPnVzZXIoKS0+dW5pdF9wZXJtaXNzaW9ucygpKQogICAgICAgIC0+d2hlcmVJbignYXNfbG9jYXRpb24nLCBhdXRoKCktPnVzZXIoKS0+bG9jYXRpb25fcGVybWlzc2lvbnMoKSkKICAgICAgICAtPndoZXJlKCdhc3NvY2lhdGVfaWQnLCAnTElLRScsICclJy4gJHZhbHVlIC4nJScpCiAgICAgICAgLT5vcldoZXJlKCdhc19uYW1lJywgJ0xJS0UnLCAnJScuICR2YWx1ZSAuICclJykKICAgICAgICAtPm9yV2hlcmUoJ2FzX29yYWNsZV9jb2RlJywgJ0xJS0UnLCAnJScuICR2YWx1ZSAuICclJykKICAgICAgICAtPmxpbWl0KDEwKQogICAgICAgIC0+Z2V0KCk7CiAgICB9CgogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRFbXBsb3llZVNoaWZ0SWRXaXNlKCRzaGlmdElkLCAkdW5pdElkKQogICAgewogICAgICAgIHJldHVybiBFbXBsb3llZTo6c2VsZWN0KCdhc19pZCcpCiAgICAgICAgLT53aGVyZUluKCdhc191bml0X2lkJywgYXV0aCgpLT51c2VyKCktPnVuaXRfcGVybWlzc2lvbnMoKSkKICAgICAgICAtPndoZXJlSW4oJ2FzX2xvY2F0aW9uJywgYXV0aCgpLT51c2VyKCktPmxvY2F0aW9uX3Blcm1pc3Npb25zKCkpCiAgICAgICAgLT53aGVyZSgnYXNfc2hpZnRfaWQnLCAkc2hpZnRJZCkKICAgICAgICAtPndoZXJlKCdhc191bml0X2lkJywgJHVuaXRJZCkKICAgICAgICAtPmdldCgpOwogICAgfQogICAgCiAgICBwdWJsaWMgIGZ1bmN0aW9uIHRvZGF5X3N0YXR1cygpCiAgICB7CiAgICAgICAgJHRvZGF5ID0gZGF0ZSgnWS1tLWQnKTsKICAgICAgICAkdGFibGUgPSBnZXRfYXR0X3RhYmxlKCR0aGlzLT5hc191bml0X2lkKTsKICAgICAgICAKICAgICAgICAkYXR0ID0gREI6OnRhYmxlKCR0YWJsZSktPndoZXJlKFsKICAgICAgICAgICAgICAgICdhc19pZCcgPT4gJHRoaXMtPmFzX2lkLAogICAgICAgICAgICAgICAgJ2luX2RhdGUnID0+ICR0b2RheQogICAgICAgICAgICBdKS0+Zmlyc3QoKTsKCiAgICAgICAgJGxlYXZlID0gTGVhdmU6OndoZXJlKCdsZWF2ZV9mcm9tJywgJz08JywgJHRvZGF5KQogICAgICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2xlYXZlX3RvJywgJz49JywgJHRvZGF5KQogICAgICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2xlYXZlX2Fzc19pZCcsICR0aGlzLT5hc3NvY2lhdGVfaWQpCiAgICAgICAgICAgICAgICAgICAgLT5maXJzdCgpOwoKICAgICAgICAvLyBpZiBsZWF2ZSBhbmQgYXR0IGJvdGggZXhpc3RzCiAgICAgICAgJGRhdGEgPSBhcnJheSgpOwoKICAgICAgICBpZigkYXR0ICE9IG51bGwgJiYgJGxlYXZlICE9IG51bGwpewogICAgICAgICAgICAkZGF0YVsnc3RhdHVzJ10gPSAnTGVhdmUnOwogICAgICAgICAgICAkZGF0YVsnaW5mbyddID0gJGxlYXZlOwogICAgICAgIH1lbHNlIGlmKCRhdHQgIT0gbnVsbCAmJiAkbGVhdmUgPT0gbnVsbCl7CiAgICAgICAgICAgICRkYXRhWydzdGF0dXMnXSA9ICdMZWF2ZSc7CiAgICAgICAgICAgICRkYXRhWydpbmZvJ10gPSAkYXR0OwogICAgICAgIH1lbHNlewogICAgICAgICAgICAkZGF0YVsnc3RhdHVzJ10gPSAnQWJzZW50JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRkYXRhOwogICAgfQoKICAgIHB1YmxpYyAgZnVuY3Rpb24gam9iX2R1cmF0aW9uKCRkYXRlKQogICAgewogICAgICAgICRqb2luZCA9IFxDYXJib25cQ2FyYm9uOjpjcmVhdGVGcm9tRm9ybWF0KCdZLW0tZCcsICR0aGlzLT5hc19kb2opOwogICAgICAgICR0aGlzZGF5ID0gXENhcmJvblxDYXJib246OmNyZWF0ZUZyb21Gb3JtYXQoJ1ktbS1kJywgJGRhdGUpOwoKICAgICAgICAkZGlmZiA9IHJvdW5kKCRqb2luZC0+ZmxvYXREaWZmSW5Nb250aHMoJHRoaXNkYXkpKTsKICAgICAgICAKCiAgICAgICAgcmV0dXJuIChpbnQpICRkaWZmOwogICAgfQoKCiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldEFjdGl2ZUVtcGxveWVlQXNJZCgpCiAgICB7CiAgICAgICAgcmV0dXJuIHNlbGY6OndoZXJlKCdhc19zdGF0dXMnLDEpLT5wbHVjaygnYXNzb2NpYXRlX2lkJywnYXNfaWQnKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0QWN0aXZpdHlsb2dPcHRpb25zKCk6IExvZ09wdGlvbnMKICAgIHsKICAgICAgICByZXR1cm4gTG9nT3B0aW9uczo6ZGVmYXVsdHMoKTsKICAgIH0KfQo=